import{i as oe,M as ee,N as de,l as h,D as N,A,n as V,q as a,h as e,H,Q as me,x as Y,F as C,r as U,k as Z,w as ae,O as ve,U as $,c as Ie,P as Ne,v as S,G as I,y as fe,L as Oe,W as Ue,a1 as De}from"./index-D1IdJcDr.js";import{O as D,G as z}from"./canDo-DUOXP-vd.js";import{a as Ce,b as Ge,P as Re}from"./permission-CXLcAQMS.js";import{V as pe}from"./VContainer-Chowp3GE.js";import{V as te,a as O}from"./VRow-BUrnHE6j.js";import{V as b}from"./VCheckbox-DsAX1z5Y.js";import{_ as ke}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-C-YEHwt2.js";import{u as we}from"./useModel-yPlLQE32.js";import{_ as ce}from"./ModelDialog.vue_vue_type_script_setup_true_lang-BNijRK1W.js";import{_ as Ve}from"./SelectTags.vue_vue_type_script_setup_true_lang-B4Vu5oD0.js";import{V as he}from"./VTextField-W5fcvv2H.js";import{V as ue}from"./VSelect-DmFXQ4Cd.js";import{G as Te,A as _e}from"./userData-Ct5iumXn.js";import{u as Ae}from"./useAvatar-C_boc_68.js";import{a as Se,_ as Le,l as Me}from"./SaveButton.vue_vue_type_script_setup_true_lang-Dwn90ysX.js";import{c as ge}from"./copyToClipboard-BtcEYe2-.js";import{_ as Fe}from"./UserSelect.vue_vue_type_script_setup_true_lang-DhhspIT4.js";import{C as Ye}from"./canManageGlobalUsers-CkdbC0sm.js";import{S as $e}from"./setupLogin-BYOoXGmW.js";import{V as L}from"./VGrid-Bv_0hRDR.js";import{V as re}from"./VSpacer-BrfhdX1T.js";import{V as je,a as We,d as xe,e as Be}from"./VList-dnLyDLDE.js";import{V as ze}from"./VDialog-Cr_Moxaz.js";import{e as qe,a as He,b as Qe,c as Je,d as Ke}from"./VCard-BoUJuUZM.js";import{V as Xe}from"./forwardRefs-KgRCCg1e.js";import{V as Ze}from"./VSheet-C8ppHz6X.js";import{V as el}from"./VToolbar-DakFPRLD.js";import{V as ll}from"./VTable-stZLBWjh.js";import{v as le}from"./v4-CtRu48qb.js";import"./VCheckboxBtn-D5dNvNW7.js";import"./index-zHJ-1AxG.js";import"./VToolbarItems-Bj17TBFH.js";import"./VAutocomplete-CaAMv7_C.js";import"./filter-Bm3v1nWh.js";import"./form-DXdcbEwW.js";import"./VChip-BEIYno7m.js";import"./VOverlay-BKZSf0y-.js";import"./scopeId-A3cp4IWG.js";import"./useStoreAPI-DRgmhfwe.js";import"./createSimpleFunctional-B6u6eakS.js";const al={key:1,class:"v-row pa-0 ma-0",style:{"list-style-position":"inside"}},tl={key:0,class:"v-col v-col-12 v-col-sm-6 pa-0 ma-0"},be=oe({__name:"EditGroupPermissions",props:ee({disabled:{type:Boolean},view:{default:"edit"}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(j){const i=de(j,"modelValue"),W=["CheckIn","EditConvention","EditOrganisation","EditPaymentTransactions","EditRegistration","ManageUsers","ManageViews","ViewPaymentTransactions","ViewRegistration","ConfigureLostAndFound","EditLostAndFound","ViewLostAndFound","ConfigureProps","EditProps","ViewProps"];return(m,s)=>m.view=="edit"?(V(),h(pe,{key:0},{default:a(()=>[e(te,null,{default:a(()=>[e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.CheckIn,"onUpdate:modelValue":s[0]||(s[0]=t=>i.value.CheckIn=t),label:"Check In","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.EditConvention,"onUpdate:modelValue":s[1]||(s[1]=t=>i.value.EditConvention=t),label:"Edit Convention","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.EditOrganisation,"onUpdate:modelValue":s[2]||(s[2]=t=>i.value.EditOrganisation=t),label:"Edit Organisation","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.EditPaymentTransactions,"onUpdate:modelValue":s[3]||(s[3]=t=>i.value.EditPaymentTransactions=t),label:"Manage Registration Payments","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.EditRegistration,"onUpdate:modelValue":s[4]||(s[4]=t=>i.value.EditRegistration=t),label:"Edit Registrations","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ManageUsers,"onUpdate:modelValue":s[5]||(s[5]=t=>i.value.ManageUsers=t),label:"Manage Users","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ManageViews,"onUpdate:modelValue":s[6]||(s[6]=t=>i.value.ManageViews=t),label:"Manage Views","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ViewPaymentTransactions,"onUpdate:modelValue":s[7]||(s[7]=t=>i.value.ViewPaymentTransactions=t),label:"View Payment Transactions","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ViewRegistration,"onUpdate:modelValue":s[8]||(s[8]=t=>i.value.ViewRegistration=t),label:"View Registrations","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ConfigureLostAndFound,"onUpdate:modelValue":s[9]||(s[9]=t=>i.value.ConfigureLostAndFound=t),label:"Configure Lost and Found","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.EditLostAndFound,"onUpdate:modelValue":s[10]||(s[10]=t=>i.value.EditLostAndFound=t),label:"Edit Lost and Found","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ViewLostAndFound,"onUpdate:modelValue":s[11]||(s[11]=t=>i.value.ViewLostAndFound=t),label:"View Lost and Found","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ConfigureProps,"onUpdate:modelValue":s[12]||(s[12]=t=>i.value.ConfigureProps=t),label:"Configure Props","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.EditProps,"onUpdate:modelValue":s[13]||(s[13]=t=>i.value.EditProps=t),label:"Edit Props","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1}),e(O,{cols:"12",sm:"6",md:"4"},{default:a(()=>[e(b,{modelValue:i.value.ViewProps,"onUpdate:modelValue":s[14]||(s[14]=t=>i.value.ViewProps=t),label:"View Props","hide-details":"",disabled:m.disabled},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})):m.view=="list"?(V(),N("ul",al,[(V(),N(H,null,me(W,t=>{var M,y;return V(),N(H,null,[(M=Object.entries(i.value).find(c=>c[0]===t))!=null&&M[1]?(V(),N("li",tl,Y((y=C(Ce).find(c=>c.value==C(Ge).get(t)))==null?void 0:y.title),1)):A("",!0)],64)}),64))])):A("",!0)}}),ol=oe({__name:"EditGroupDialog",props:ee({conventions:{},organisations:{},group:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:ee(["update:group","save"],["update:modelValue"]),setup(j,{emit:i}){const W=j,m=ve(),{conventions:s,organisations:t,title:M=""}=W,y=i,c=de(j,"modelValue"),E=we(W,y,void 0,void 0,"group"),l=U(Z(E.value));l.value.Tags||(l.value.Tags=[]);const w=U(null);l.value.OwnerType===D.OWNER_TYPE_CONVENTION?w.value=s.filter(p=>p.ConventionUUID==l.value.OwnerUUID).map(p=>p.ConventionUUID).join(""):l.value.OwnerType===D.OWNER_TYPE_ORGANISATION?w.value=t.filter(p=>p.OrganisationUUID==l.value.OwnerUUID).map(p=>p.OrganisationUUID).join(""):(l.value.Type===z.GROUP_TYPE_SYSTEM||l.value.Type===z.GROUP_TYPE_ADMIN)&&(w.value=null),ae(E,()=>{l.value=Z(E.value)});const T=U({ID:0,PermissionUUID:$,GroupID:0,GroupUUID:$,CheckIn:!1,EditConvention:!1,EditOrganisation:!1,EditPaymentTransactions:!1,EditRegistration:!1,ViewPaymentTransactions:!1,ViewRegistration:!1,ManageUsers:!1,ManageViews:!1,ConfigureProps:!1,EditProps:!1,ViewProps:!1,ConfigureLostAndFound:!1,EditLostAndFound:!1,ViewLostAndFound:!1});m.getPermission(z.GROUP_TYPE_SYSTEM,$).then(p=>{T.value=p,R()}).catch(()=>{});const G=()=>{l.value=Z(E.value),R()},_=p=>{if(w.value==null)l.value.Type=z.GROUP_TYPE_ADMIN,l.value.OwnerType=null,l.value.OwnerID=null,l.value.OwnerUUID=null;else{const u=x.value.find(g=>w.value===g.OwnerUUID);u&&(u.OwnerType==D.OWNER_TYPE_ORGANISATION?l.value.Type=z.GROUP_TYPE_ORGANISATION:u.OwnerType==D.OWNER_TYPE_CONVENTION&&(l.value.Type=z.GROUP_TYPE_CONVENTION),l.value.OwnerType=u.OwnerType,l.value.OwnerID=u.OwnerID,l.value.OwnerUUID=u.OwnerUUID)}m.saveGroup(l.value).then(u=>{u&&p&&p("Group Saved").then(()=>{E.value=u,y("save",u)})}).catch(()=>{p&&p("Failed to Save Group")})},R=()=>{const p=x.value.find(u=>l.value.OwnerUUID===u.OwnerUUID);p?w.value=p.OwnerUUID:x.value.length>0&&(w.value=null)},x=Ie(()=>{const p=[];return T.value.ManageUsers&&p.push({Label:"System Admin",OwnerID:null,OwnerUUID:null,OwnerType:null}),p.push(...s.map(u=>({Label:`${u.Name} (Convention)`,OwnerID:u.ID,OwnerUUID:u.ConventionUUID,OwnerType:D.OWNER_TYPE_CONVENTION}))),p.push(...t.map(u=>({Label:`${u.Name} (Organisation)`,OwnerID:u.ID,OwnerUUID:u.OrganisationUUID,OwnerType:D.OWNER_TYPE_ORGANISATION}))),p});return R(),(p,u)=>(V(),h(ce,{modelValue:c.value,"onUpdate:modelValue":u[5]||(u[5]=g=>c.value=g),onReset:G,onSave:_,title:C(M),color:"primary","show-close-action":!0,"show-reset-action":!0,"show-save-action":!0,fullscreen:!0,persistent:!0},{default:a(()=>[e(pe,{class:"pa-0",fluid:!0},{default:a(()=>[e(te,null,{default:a(()=>[e(O,{cols:"12",md:"6"},{default:a(()=>[e(he,{modelValue:l.value.Name,"onUpdate:modelValue":u[0]||(u[0]=g=>l.value.Name=g),label:"Name",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(O,{cols:"12",md:"6"},{default:a(()=>[e(ue,{modelValue:w.value,"onUpdate:modelValue":u[1]||(u[1]=g=>w.value=g),label:"Owner",items:x.value,"item-title":"Label","item-value":"OwnerUUID",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(O,{cols:"12"},{default:a(()=>[e(be,{modelValue:l.value.Permission,"onUpdate:modelValue":u[2]||(u[2]=g=>l.value.Permission=g),disabled:!1},null,8,["modelValue"])]),_:1}),e(O,{cols:"12"},{default:a(()=>[l.value.OwnerType===C(D).OWNER_TYPE_CONVENTION?(V(),h(Ve,{key:0,modelValue:l.value.Tags,"onUpdate:modelValue":u[3]||(u[3]=g=>l.value.Tags=g),label:"oAuth Security Tags",hint:"These are not applied directly to members of the group, they are for oAuth only.",convention:C(s).find(g=>g.ConventionUUID==l.value.OwnerUUID)},null,8,["modelValue","convention"])):l.value.OwnerType===C(D).OWNER_TYPE_ORGANISATION?(V(),h(Ve,{key:1,modelValue:l.value.Tags,"onUpdate:modelValue":u[4]||(u[4]=g=>l.value.Tags=g),label:"oAuth Security Tags",hint:"These are not applied directly to members of the group, they are for oAuth only.",organisation:C(t).find(g=>g.OrganisationUUID==l.value.OwnerUUID)},null,8,["modelValue","organisation"])):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"]))}}),sl={key:1},nl=["href"],il=["href"],ul=oe({__name:"EditGroupMembersDialog",props:ee({group:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:ee(["update:group","save"],["update:modelValue"]),setup(j,{emit:i}){const W=j,m=ve(),s=Ae(),t=Te(),{title:M=""}=W,y=i,c=de(j,"modelValue"),E=we(W,y,void 0,void 0,"group"),l=U(Z(E.value)),w=U(""),T=U(!1),G=U($);(l.value.Users==null||l.value.Users.length==0)&&m.getGroupMembers(l.value.GroupUUID).then(d=>{d&&(l.value.Users=d)}).catch(()=>{l.value.Users=[]});const _=U(""),R=U(""),x=()=>{m.getGroupInvite(l.value.GroupUUID).then(d=>{if(d){const v=new URL(location.href);v.searchParams.set("token",d),_.value=v.toString()}})};x();const p=()=>{m.getGroupInfiniteInvite(l.value.GroupUUID).then(d=>{if(d){const v=new URL(location.href);v.searchParams.set("token",d),R.value=v.toString()}})};p(),ae(E,()=>{l.value=Z(E.value)});const u=()=>{ge(_.value),x()},g=()=>{ge(R.value),p()},q=U(!1),B=U(-1),K=U(""),F=()=>{B.value=-1,q.value=!1},X=d=>{B.value=d,q.value=!0},k=()=>{(!G.value||G.value===$)&&(w.value="Invalid User",T.value=!0),m.addUserToGroup(G.value,l.value.GroupUUID).then(d=>{d?(l.value=d,w.value="User added to group",T.value=!0):(w.value="Error adding user to group",T.value=!0)}).catch(d=>{w.value="Error adding user to group: "+d,T.value=!0})},P=({callback:d})=>{if(!l.value.Users){d&&(d("Failed to Remove User"),setTimeout(F,2e3));return}K.value="",B.value<0||B.value>=l.value.Users.length?(d&&d("Invalid Convention"),setTimeout(F,2e3)):m.removeUserFromGroup(l.value.Users[B.value].UserUUID,l.value.GroupUUID).then(v=>{var f;v?((f=l.value.Users)==null||f.splice(B.value,1),d&&d("User Removed")):d&&d("Failed to Remove User"),setTimeout(F,2e3)}).catch(()=>{d&&(d("Failed to Remove User"),setTimeout(F,2e3))})},se=d=>{const v=Oe();m.switchUser(d).then(f=>{f&&$e(f.tokens,f.user,v,!1)}).catch(f=>{console.error(f)})};return(d,v)=>(V(),h(ce,{modelValue:c.value,"onUpdate:modelValue":v[3]||(v[3]=f=>c.value=f),title:C(M),color:"primary",fullscreen:!0,persistent:!0},Ne({default:a(()=>[e(pe,{class:"pa-0",fluid:!0},{default:a(()=>[l.value.Users&&l.value.Users.length?(V(),N(H,{key:0},[e(je,null,{default:a(()=>[(V(!0),N(H,null,me(l.value.Users,(f,ne)=>(V(),h(We,{key:f.UserUUID},{append:a(()=>[e(L,{color:"red-darken-3",icon:"mdi:mdi-window-close",size:"x-small",onClick:ie=>X(ne)},null,8,["onClick"])]),prepend:a(()=>[e(Xe,{src:C(s)(f.UserUUID),class:"rounded-circle mr-2",height:"32",width:"32"},null,8,["src"])]),default:a(()=>[e(xe,null,{default:a(()=>[S(Y(f.DisplayName)+" ",1),C(Ye)(C(t))?(V(),h(L,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",size:"small",onClick:ie=>se(f.UserUUID)},null,8,["onClick"])):A("",!0)]),_:2},1024),e(Be,null,{default:a(()=>[S(Y(f.Handle?`(${f.Handle})`:""),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(ze,{modelValue:q.value,"onUpdate:modelValue":v[2]||(v[2]=f=>q.value=f),width:"auto"},{default:a(()=>[e(qe,null,{default:a(()=>[e(He,null,{default:a(()=>v[5]||(v[5]=[S(" Remove User from Group ")])),_:1}),e(Qe,null,{default:a(()=>v[6]||(v[6]=[S(" User will no longer have the permissions from this group. ")])),_:1}),e(Je,null,{default:a(()=>[e(te,null,{default:a(()=>[e(O,null,{default:a(()=>v[7]||(v[7]=[I("p",null," Are you sure you wish to remove this user? If they have permissions from another group these will still be usable. To add the user back into the group you may need to provide them with a new invite link. ",-1)])),_:1})]),_:1})]),_:1}),e(Ke,null,{default:a(()=>[e(L,{color:"primary",onClick:F},{default:a(()=>v[8]||(v[8]=[S("Cancel")])),_:1}),e(re),e(Le,{color:"red-darken-3",label:"Remove User",onClick:P})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):(V(),N("p",sl," No members "))]),_:1})]),actions:a(()=>[e(L,{variant:"text"},{default:a(()=>[I("a",{href:R.value,onClick:fe(g,["prevent"])},"Infinite Use Invite URL",8,nl)]),_:1}),e(re),e(L,{variant:"text"},{default:a(()=>[I("a",{href:_.value,onClick:fe(u,["prevent"])},"Invite URL",8,il)]),_:1})]),_:2},[d.group.OwnerType===C(D).OWNER_TYPE_CONVENTION&&d.group.OwnerUUID?{name:"extension",fn:a(()=>[e(te,null,{default:a(()=>[e(O,null,{default:a(()=>[e(Fe,{modelValue:G.value,"onUpdate:modelValue":v[0]||(v[0]=f=>G.value=f),convention:d.group.OwnerUUID,"null-label":"- Select User -",variant:"plain"},null,8,["modelValue","convention"])]),_:1}),e(O,{class:"pt-5"},{default:a(()=>[e(L,{onClick:k,variant:"flat",class:"mt-2",color:"success","prepend-icon":"mdi:mdi-account-plus"},{default:a(()=>v[4]||(v[4]=[S(" Add User ")])),_:1})]),_:1})]),_:1}),e(Se,{message:w.value,modelValue:T.value,"onUpdate:modelValue":v[1]||(v[1]=f=>T.value=f)},null,8,["message","modelValue"])]),key:"0"}:void 0]),1032,["modelValue","title"]))}}),rl={key:0,class:"text-center mt-5 text-red text-h5"},dl={key:1,class:"text-center mt-5"},ml={class:"d-block d-md-none mt-2"},vl={class:"d-none d-md-table-cell"},pl={class:"text-no-wrap pa-1 pa-md-4"},ea=oe({__name:"GroupsView",emits:["pageTitle"],setup(j,{emit:i}){i("pageTitle","Manage Groups & Permissions");const m=ve(),s=Te(),t=Oe(),M=U(!1),y=U(),c=U(),E=U([]),l=U([]),w=U([]),T=U(!1),G=U(!1),_=U(!1),R=U(""),p=new URL(location.href).searchParams.get("token")||"",u=n=>{const o=()=>{const r=sessionStorage.getItem("gjt_attempt");let Q=Me.parseInt(r||"0");Q<2?(sessionStorage.setItem("gjt_attempt",(Q+1).toString()),setTimeout(()=>{location.reload()},2e3)):(sessionStorage.removeItem("gjt_attempt"),localStorage.removeItem("gjt_token"),R.value="There was a problem with this token, it may have expired or already been used.",setTimeout(()=>{t.push("/")},5e3))};m.validateGroupInviteToken(n).then(r=>{r?(_e(r),localStorage.removeItem("gjt_token"),sessionStorage.setItem("reload","true"),t.push("/")):o()}).catch(()=>{o()})};p!==""?(localStorage.setItem("gjt_token",location.href),u(p)):(M.value=!0,(!s||!s.Groups.find(n=>n.Permission.ManageUsers))&&t.push("/")),ae(y,()=>{K(c.value,y.value)}),ae(c,()=>{K(c.value,y.value)});const g=n=>n.OwnerType===D.OWNER_TYPE_CONVENTION?E.value.filter(o=>o.ConventionUUID===n.OwnerUUID).map(o=>o.Name).join(""):n.OwnerType===D.OWNER_TYPE_ORGANISATION?w.value.filter(o=>o.OrganisationUUID===n.OwnerUUID).map(o=>o.Name).join(""):n.OwnerType===void 0||n.OwnerType===null?"System":"Unknown",q=n=>n.OwnerType===D.OWNER_TYPE_CONVENTION?"Convention":n.OwnerType===D.OWNER_TYPE_ORGANISATION?"Organisation":n.OwnerType===void 0||n.OwnerType===null?"Global":"Unknown",B=()=>{m.getPermissionAccessList(Re.PERMISSION_TYPE_MANAGE_USERS).then(n=>{E.value=n.Conventions,w.value=n.Organisations}).catch(()=>{})},K=(n=$,o=$)=>{m.getManageableGroups(n||$,o||$).then(r=>{r&&(l.value=r.sort((Q,J)=>Q.Name>J.Name?1:-1))}).catch(()=>{})},F=()=>{const n={ID:0,GroupUUID:le(),Type:z.GROUP_TYPE_CONVENTION,Name:"",MinimumNumbers:0,Permission:{ID:0,PermissionUUID:le(),GroupID:0,GroupUUID:le(),CheckIn:!1,EditConvention:!1,EditOrganisation:!1,EditPaymentTransactions:!1,EditRegistration:!1,ManageUsers:!1,ManageViews:!1,ViewPaymentTransactions:!1,ViewRegistration:!1,ConfigureProps:!1,EditProps:!1,ViewProps:!1,ConfigureLostAndFound:!1,EditLostAndFound:!1,ViewLostAndFound:!1},Tags:[],Users:[],OwnerID:null,OwnerType:null,OwnerUUID:null};return n.Permission.GroupUUID=n.GroupUUID,n},X=U(F()),k=U(-1),P=U(F()),se=Ie(()=>k.value===-1?"New Group":"Edit Group"),d=()=>{X.value.GroupUUID=le(),P.value=Object.assign({},F()),k.value=-1,T.value=!0},v=n=>{k.value=l.value.indexOf(n),P.value=Object.assign({},n),G.value=!0},f=n=>{k.value=l.value.indexOf(n),P.value=Object.assign({},n),T.value=!0},ne=n=>{k.value=l.value.indexOf(n),P.value=Object.assign({},n),_.value=!0},ie=()=>{m.deleteGroup(P.value.GroupUUID).then(n=>{n&&(l.value.splice(k.value,1),Ee())})},ye=()=>{T.value=!1,Ue(()=>{P.value=Object.assign({},X.value),k.value=-1})},Ee=()=>{_.value=!1,Ue(()=>{P.value=Object.assign({},X.value),k.value=-1})},Pe=n=>{k.value>-1?Object.assign(l.value[k.value],n):l.value.push(n),ye()};return B(),K(c.value,y.value),(n,o)=>(V(),N("div",null,[M.value?(V(),N(H,{key:1},[e(el,{color:"primary"},{default:a(()=>[e(ue,{label:"Organisation",modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=r=>c.value=r),items:w.value,"item-value":"OrganisationUUID","item-title":"Name",clearable:!0,"hide-details":"",class:"mr-1"},null,8,["modelValue","items"]),e(ue,{label:"Convention",modelValue:y.value,"onUpdate:modelValue":o[1]||(o[1]=r=>y.value=r),items:E.value,"item-value":"ConventionUUID","item-title":"Name",clearable:!0,"hide-details":""},null,8,["modelValue","items"]),e(re),e(L,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:d},{default:a(()=>o[8]||(o[8]=[S(" New Group ")])),_:1}),e(ke,{modelValue:_.value,"onUpdate:modelValue":o[2]||(o[2]=r=>_.value=r),onDelete:ie},null,8,["modelValue"])]),_:1}),T.value?(V(),h(ol,{key:0,modelValue:T.value,"onUpdate:modelValue":o[3]||(o[3]=r=>T.value=r),group:P.value,"onUpdate:group":o[4]||(o[4]=r=>P.value=r),onSave:Pe,title:se.value,conventions:E.value,organisations:w.value},null,8,["modelValue","group","title","conventions","organisations"])):A("",!0),G.value?(V(),h(ul,{key:1,modelValue:G.value,"onUpdate:modelValue":o[5]||(o[5]=r=>G.value=r),group:P.value,"onUpdate:group":o[6]||(o[6]=r=>P.value=r),title:`${P.value.Name}`},null,8,["modelValue","group","title"])):A("",!0),e(ll,null,{default:a(()=>[o[13]||(o[13]=I("thead",null,[I("tr",null,[I("th",null,"Name"),I("th",{class:"d-none d-md-table-cell"}," Owner "),I("th",null,"Permissions"),I("th")])],-1)),I("tbody",null,[(V(!0),N(H,null,me(l.value,(r,Q)=>(V(),N("tr",{key:r.GroupUUID,class:De(Q%2?"bg-grey-lighten-4":"")},[I("td",null,[S(Y(r.Name)+" ",1),I("p",ml,[o[9]||(o[9]=I("strong",null,"Owner",-1)),o[10]||(o[10]=I("br",null,null,-1)),S(" "+Y(g(r)),1),o[11]||(o[11]=I("br",null,null,-1)),I("small",null,"("+Y(q(r))+")",1)])]),I("td",vl,[S(Y(g(r)),1),o[12]||(o[12]=I("br",null,null,-1)),I("small",null,"("+Y(q(r))+")",1)]),I("td",null,[r.Permission?(V(),h(be,{key:0,modelValue:r.Permission,"onUpdate:modelValue":J=>r.Permission=J,view:"list",disabled:!0},null,8,["modelValue","onUpdate:modelValue"])):A("",!0)]),I("td",pl,[e(L,{icon:"mdi:mdi-account-group",size:"x-small",color:"success",class:"mb-1",onClick:J=>v(r)},null,8,["onClick"]),r.Type!==C(z).GROUP_TYPE_SYSTEM?(V(),N(H,{key:0},[e(L,{icon:"mdi:mdi-pencil",size:"x-small",color:"primary",class:"mb-1",onClick:J=>f(r)},null,8,["onClick"]),e(L,{icon:"mdi:mdi-delete",size:"x-small",color:"error",class:"mb-1",onClick:J=>ne(r)},null,8,["onClick"])],64)):A("",!0)])],2))),128))])]),_:1})],64)):(V(),h(Ze,{key:0,elevation:"2",class:"pa-4"},{default:a(()=>[o[7]||(o[7]=I("h1",{class:"text-center mt-5"},"Processing Invite...",-1)),R.value?(V(),N("p",rl,Y(R.value),1)):A("",!0),R.value?(V(),N("p",dl,"Please contact your admin and request a new one")):A("",!0)]),_:1}))]))}});export{ea as default};
