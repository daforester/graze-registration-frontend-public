import{s as h}from"./index-zHJ-1AxG.js";import{i as M,M as w,N as q,r as C,c as te,w as le,l as b,n as c,k as z,q as l,h as e,v as N,F as y,A as x,O as B,D as R,H as A,G as S,Q as L,x as P,y as Q,m as Ne,V as Oe,W as Se,X as Ee,Y as Pe,P as Te,U as Re,C as _e,s as ie,Z as je,_ as ul,R as il,S as Me}from"./index-DWoJBaAj.js";import{s as se,m as Ie,a as ge,b as dl}from"./useConventionSlug-CkFQ5rCe.js";import{I as J,_ as ee}from"./SelectTags.vue_vue_type_script_setup_true_lang-CsJPcuQ1.js";import{_ as ae}from"./SaveButton.vue_vue_type_script_setup_true_lang-CH1oplkq.js";import{V as Je}from"./VAutocomplete-DzapmP1t.js";import{e as me,c as ye}from"./VCard-Bh0GtTSC.js";import{V as ve,a as pe}from"./VToolbar-CHLZske4.js";import{V as F,d as X,o as Ge}from"./VGrid-BjgFpAZn.js";import{V as ne}from"./VSpacer-qSTNPCcP.js";import{V as be}from"./VToolbarItems-D6wB2i_0.js";import{V as j}from"./VContainer-BFcMrVbM.js";import{V as _,a as D}from"./VRow-t6XUObGt.js";import{V as O}from"./VTextField-DEVkKC1W.js";import{_ as Fe}from"./SelectGroups.vue_vue_type_script_setup_true_lang-BkEjXYqn.js";import{V as xe,a as de,e as ue,c as $e,b as We}from"./VList-BQEmKFTx.js";import{V as Ce}from"./VDialog-yG2h32Ey.js";import{v as $}from"./v4-CtRu48qb.js";import{V as ce,a as Ve,b as Ue,c as De}from"./VExpansionPanels-CCwRhO7n.js";import{V as fe}from"./VTextarea-ButTdGsl.js";import{T as G,a as sl}from"./ticket-DqurB3v3.js";import{V as Z}from"./VSelect-CyajT2HP.js";import{V as H}from"./VCheckbox-BRsi-ygj.js";import{V as Xe,a as Ke}from"./VChip-BZ6_PRg8.js";import{V as rl}from"./VTable-BRlXJ9u2.js";import{V as oe}from"./VSheet-BC3ozFky.js";import{_ as Be}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-B-Uq_042.js";import{u as re}from"./useModel-DOTj7t8M.js";import{_ as Ye}from"./ModelDialog.vue_vue_type_script_setup_true_lang-CxMvc_Zx.js";import{p as ml,F as Ze,a as Y,_ as Qe,b as vl}from"./FormRenderer.vue_vue_type_style_index_0_lang-DfiUxiEF.js";import{V as el}from"./VDataTable-DX8BXXOk.js";import{a as pl,F as fl}from"./form-Cqw16b_M.js";import{_ as ll,u as cl}from"./useLinkedFields-CzeC1gr1.js";import{b as Vl}from"./forwardRefs-DoDzwsLS.js";import{E as Ul}from"./EditConventionDialog-CSo7PCPv.js";import{u as Dl}from"./useConventionForms-BuKmEUF4.js";import{V as He}from"./VForm-BY0o21Pz.js";import{u as Tl}from"./useStripeConfig-D5vbXyZ1.js";import{V as Il}from"./VTooltip-JtHlEYzA.js";import{V as gl,a as yl}from"./VAlert-DnYhM54q.js";import{V as we,a as qe,b as he,c as Le}from"./VTabs-Dyid0o6g.js";import{u as tl}from"./useConventionConfig-CV7Miafj.js";import"./VOverlay-CpOp3qgP.js";import"./scopeId-Cl_fsoSS.js";import"./filter-BnNNQUzF.js";import"./form-B38mwiHr.js";import"./VCheckboxBtn-hdHe9uQb.js";import"./createSimpleFunctional-D3jYYgwj.js";import"./submission-DAi9v6uc.js";import"./copyToClipboard-BtcEYe2-.js";import"./useStoreAPI-BEVb_7_l.js";import"./VFileInput-DagrXe6S.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./userData-BXpzz9OU.js";var Ae=(T=>(T.PER_ROOM="PER_ROOM",T.PER_PERSON="PER_PERSON",T))(Ae||{}),al=(T=>(T.INCREMENTAL="INCREMENTAL_NUMBERS",T.NONE="",T.RANDOM_LETTERS="RANDOM_LETTERS",T.RANDOM_NUMBERS="RANDOM_NUMBERS",T))(al||{}),ol=(T=>(T.NONE="",T))(ol||{});const bl=[{title:"Do Not Assign",value:""},{title:"Incremental Numbers",value:"INCREMENTAL_NUMBERS"},{title:"Random Numbers",value:"RANDOM_NUMBERS"},{title:"Random Letters",value:"RANDOM_LETTERS"}],Cl=[{title:"Do Not Generate",value:""}],kl=M({__name:"SelectOptions",props:w({option:{},options:{default:()=>[]},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{},showUUID:{type:Boolean,default:!1},inputType:{default:()=>J.UNKNOWN}},{modelValue:{required:!0},modelModifiers:{}}),emits:w(["change"],["update:modelValue"]),setup(T,{emit:p}){const o=q(T,"modelValue"),d=p,v=C([]);let i=T.inputType;const n=te(()=>T.options.filter(a=>a.OptionUUID!=T.option.OptionUUID).map(a=>({title:`${a.Name}${T.showUUID?` (${a.OptionUUID})`:""}`,value:v.value.find(s=>s&&s.OptionUUID&&s.OptionUUID===a.OptionUUID)||a}))),u=()=>{switch(i){default:case J.OPTION:{o.value=v.value,d("change");break}case J.JSON:{o.value=JSON.stringify(v.value),d("change");break}case J.STRING:{o.value=JSON.stringify(v.value.map(a=>a&&a.OptionUUID?a.OptionUUID:"")),d("change");break}case J.UUID_ARRAY:{o.value=v.value.map(a=>a&&a.OptionUUID?a.OptionUUID:""),d("change");break}}},t=()=>{if(T.inputType===J.OPTION||T.inputType===J.UNKNOWN&&Array.isArray(o.value))i=J.OPTION,n.value.forEach(a=>{Array.isArray(o.value)&&o.value.find(f=>f.OptionUUID===a.value.OptionUUID)&&v.value.push(a.value)});else if(T.inputType===J.JSON||T.inputType===J.UNKNOWN&&typeof o.value=="string"){i=J.JSON;try{const a=JSON.parse(o.value);n.value.forEach(s=>{a.find(U=>U.OptionUUID===s.value.OptionUUID)&&v.value.push(s.value)})}catch{}}else if(T.inputType===J.UUID_ARRAY){i=J.UUID_ARRAY;try{const a=o.value;v.value=a.map(s=>T.options.find(f=>f.OptionUUID==s))}catch{}}else if(T.inputType===J.STRING){i=J.STRING;try{if(typeof o.value!="string")return;const a=JSON.parse(o.value);v.value=a.map(s=>T.options.find(f=>f.OptionUUID==s))}catch{}}};return le(v,u),t(),(a,s)=>(c(),b(Je,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=f=>v.value=f),chips:a.chips,multiple:"",label:a.label||"Options",variant:a.variant||"solo",hint:a.hint,"persistent-hint":!0,clearable:a.clearable,items:n.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),El=M({__name:"EditConventionExtraOptions",props:w({convention:{},options:{}},{modelValue:{},modelModifiers:{}}),emits:w(["close"],["update:modelValue"]),setup(T,{emit:p}){const o=p,d=q(T,"modelValue"),v=C(z(d.value)),i=()=>{d.value=v.value,o("close")};return(n,u)=>(c(),b(me,null,{default:l(()=>[e(ve,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:u[0]||(u[0]=t=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>u[8]||(u[8]=[N("mdi:mdi-close")])),_:1})]),_:1}),e(pe,null,{default:l(()=>u[9]||(u[9]=[N("Edit Option Choice")])),_:1}),e(ne),e(be,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>u[10]||(u[10]=[N(" Apply ")])),_:1})]),_:1})]),_:1}),e(ye,{class:"pa-0"},{default:l(()=>[e(j,null,{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelName,type:"text",variant:"outlined","hide-details":"",modelValue:v.value.Name,"onUpdate:modelValue":u[1]||(u[1]=t=>v.value.Name=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelDescription,type:"text",variant:"outlined","hide-details":"",modelValue:v.value.Description,"onUpdate:modelValue":u[2]||(u[2]=t=>v.value.Description=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelPrice,type:"text",variant:"outlined","prepend-icon":y(h).currencyIcon,modelValue:v.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>v.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option","persistent-hint":""},null,8,["label","prepend-icon","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelRadioGroup,type:"text",variant:"outlined","prepend-icon":"mdi:mdi-radiobox-indeterminate-variant",modelValue:v.value.RadioGroup,"onUpdate:modelValue":u[4]||(u[4]=t=>v.value.RadioGroup=t),hint:"Used to form radio button groups, name should be unique per group","persistent-hint":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ee,{modelValue:v.value.Tags,"onUpdate:modelValue":u[5]||(u[5]=t=>v.value.Tags=t),convention:n.convention,hint:"Tags acquired by selecting this option & any choice within it."},null,8,["modelValue","convention"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[v.value.Choices?(c(),b(ee,{key:0,modelValue:v.value.Choices,"onUpdate:modelValue":u[6]||(u[6]=t=>v.value.Choices=t),convention:n.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):x("",!0)]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(kl,{modelValue:v.value.Parents,"onUpdate:modelValue":u[7]||(u[7]=t=>v.value.Parents=t),label:"Required Options",option:v.value,options:n.options,hint:"Parent option (any one) that must be selected to activate this one."},null,8,["modelValue","option","options"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Nl=M({__name:"EditConventionExtra",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=C(z(p.value));se(o.value.Options);const d=C(!1),v=C(0),i=B(),n=C([""]),u=C([]),t=C([]);T.convention&&(i.getConventionTags(T.convention.ConventionUUID).then(r=>{t.value=r.sort((V,g)=>V.Title.localeCompare(g.Title))}),i.getOrganisationTags(T.convention.OrganisationUUID).then(r=>{u.value=r.sort((V,g)=>V.Title.localeCompare(g.Title))}));const a=te(()=>[...u.value,...t.value]),s=({callback:r})=>{se(o.value.Options),i.saveExtra(o.value).then(V=>{V?(p.value=V,r&&r("Extra Saved")):r&&r("Failed to Save Extra")}).catch(()=>{r&&r("Failed to Save Extra")})},f=r=>{var V;r.Options||(r.Options=[]),r.Options.push({ID:0,OptionUUID:$(),ExtraID:r.ID,ExtraUUID:r.ExtraUUID,Order:((V=r.Options)==null?void 0:V.length)+1,Name:"",Description:"",Price:0,RadioGroup:"",Choices:[],Tags:[],Parents:[]})},U=(r,V)=>{r.Options&&r.Options.splice(V,1),se(r.Options)},m=r=>{if(r.Choices&&r.Choices.length>0)return r.Choices.map(V=>{const g=a.value.find(k=>k.TagUUID===V.TagUUID);if(g)return g.Title}).join(", ")};return(r,V)=>(c(),R(A,null,[e(j,{class:"px-0"},{default:l(()=>[e(O,{label:y(h).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":V[0]||(V[0]=g=>o.value.Name=g)},null,8,["label","modelValue"]),e(O,{label:y(h).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":V[1]||(V[1]=g=>o.value.Description=g)},null,8,["label","modelValue"]),e(ee,{modelValue:o.value.AppliesTags,"onUpdate:modelValue":V[2]||(V[2]=g=>o.value.AppliesTags=g),convention:r.convention,organisation:r.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(ee,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":V[3]||(V[3]=g=>o.value.RequiredTags=g),convention:r.convention,organisation:r.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this extra. (Any one)"},null,8,["modelValue","convention","organisation"]),e(Fe,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":V[4]||(V[4]=g=>o.value.RequiredGroupMemberships=g),convention:r.convention,organisation:r.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this extra. (Any one)"},null,8,["modelValue","convention","organisation"]),V[11]||(V[11]=S("h3",null,"Options",-1)),e(xe,{opened:n.value,"onUpdate:opened":V[5]||(V[5]=g=>n.value=g)},{default:l(()=>[(c(!0),R(A,null,L(o.value.Options,(g,k)=>(c(),R(A,{key:g.ID},[g?(c(),b(de,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${g.Name} ${g.Price&&g.Price>0?`(${y(h).currencySymbol}${g.Price})`:""}`},{append:l(()=>[e(F,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:I=>U(o.value,k)},null,8,["onClick"]),e(F,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",class:"mr-1",onClick:I=>{d.value=!0,v.value=k}},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:Q(I=>y(Ie)(g,o.value.Options),["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-0",onClick:Q(I=>y(ge)(g,o.value.Options),["stop"])},null,8,["onClick"])]),default:l(()=>[g.Choices&&g.Choices.length>0?(c(),b(ue,{key:0},{default:l(()=>[N(" Options: "+P(m(g)),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"])):x("",!0)],64))),128))]),_:1},8,["opened"]),e(F,{color:"primary",onClick:V[6]||(V[6]=g=>f(o.value))},{default:l(()=>V[10]||(V[10]=[N("Add Option")])),_:1}),e(_,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(ae,{onClick:s})]),_:1})]),_:1})]),_:1}),e(Ce,{modelValue:d.value,"onUpdate:modelValue":V[9]||(V[9]=g=>d.value=g),scrollable:""},{default:l(()=>[e(El,{modelValue:o.value.Options[v.value],"onUpdate:modelValue":V[7]||(V[7]=g=>o.value.Options[v.value]=g),convention:r.convention,options:o.value.Options,onClose:V[8]||(V[8]=g=>d.value=!1)},null,8,["modelValue","convention","options"])]),_:1},8,["modelValue"])],64))}}),Sl=M({__name:"EditConventionExtras",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:w(["close"],["update:modelValue"]),setup(T,{emit:p}){const o=p,d=q(T,"modelValue"),v=B(),i=()=>{const t={ID:0,ExtraUUID:$(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:d.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[],Tags:[]};v.saveExtra(t).then(a=>{a&&d.value.push(a)})},n=t=>{v.deleteExtra(d.value[t].ExtraUUID).then(a=>{a&&d.value.splice(t,1)})},u=(...t)=>{t.forEach(a=>{a>=0&&a<d.value.length&&v.saveExtra(d.value[a])})};return(t,a)=>(c(),b(me,null,{default:l(()=>[e(ve,{dark:"",color:"primary"},{default:l(()=>[e(pe,null,{default:l(()=>a[1]||(a[1]=[N("Edit Extras")])),_:1}),e(ne),e(be,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>a[2]||(a[2]=[N(" Add ")])),_:1}),e(F,{icon:"",dark:"",onClick:a[0]||(a[0]=s=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[N("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(ye,{class:"pa-0"},{default:l(()=>[e(ce,null,{default:l(()=>[(c(!0),R(A,null,L(d.value,(s,f)=>(c(),b(Ve,{key:s.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:U})=>[e(F,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:m=>n(f)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:U?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:Q(U=>{y(Ie)(s,d.value),u(f,f-1)},["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:Q(U=>{y(ge)(s,d.value),u(f,f+1)},["stop"])},null,8,["onClick"]),N(" "+P(s.Name)+" ",1)]),_:2},1024),e(De,{class:"px-0"},{default:l(()=>[e(Nl,{convention:t.convention,modelValue:d.value[f],"onUpdate:modelValue":U=>d.value[f]=U},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Rl=M({__name:"Extras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=C([]),d=B(),v=C([""]),i=C(!1),n=t=>{if(t.Choices&&t.Choices.length>0)return t.Choices.map(a=>a.Title).join(", ")},u=()=>{i.value=!1};return d==null||d.getConventionExtras(p.value.ConventionUUID||"").then(t=>{t&&(o.value=t)}),(t,a)=>(c(),R(A,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(_,null,{default:l(()=>[e(D,null,{default:l(()=>a[4]||(a[4]=[S("h3",null,"Additional Purchases",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(F,{color:"primary",onClick:a[0]||(a[0]=s=>i.value=!0)},{default:l(()=>a[5]||(a[5]=[N("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),a[6]||(a[6]=S("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1)),e(xe,{opened:v.value,"onUpdate:opened":a[1]||(a[1]=s=>v.value=s)},{default:l(()=>[(c(!0),R(A,null,L(o.value,s=>(c(),b($e,{key:s.ID,value:s.ID},{activator:l(({props:f})=>[e(de,Ne({ref_for:!0},f,{"prepend-icon":"mdi:mdi-group",title:s.Name}),null,16,["title"])]),default:l(()=>[s.Options?(c(!0),R(A,{key:0},L(s.Options,f=>(c(),b(de,{key:f.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${f.Name} ${f.Price&&f.Price>0?`(${y(h).currencySymbol}${f.Price})`:""}`},{default:l(()=>[f.Choices&&f.Choices.length>0?(c(),b(ue,{key:0},{default:l(()=>[N(" Options: "+P(n(f)),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"]))),128)):x("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Ce,{modelValue:i.value,"onUpdate:modelValue":a[3]||(a[3]=s=>i.value=s),scrollable:!0,persistent:!0,fullscreen:!0},{default:l(()=>[e(Sl,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value=s),convention:p.value,onClose:u},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),_l=M({__name:"EditConventionInterest",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=C(z(p.value)),d=B(),v=({callback:i})=>{d.saveInterest(o.value).then(n=>{n?(p.value=n,i&&i("Interest Saved")):i&&i("Failed to Save Interest")}).catch(()=>{i&&i("Failed to Save Interest")})};return(i,n)=>(c(),b(j,{class:"px-0"},{default:l(()=>[e(O,{label:y(h).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":n[0]||(n[0]=u=>o.value.Name=u)},null,8,["label","modelValue"]),e(fe,{label:y(h).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":n[1]||(n[1]=u=>o.value.Description=u)},null,8,["label","modelValue"]),x("",!0),e(ee,{modelValue:o.value.AppliesTags,"onUpdate:modelValue":n[3]||(n[3]=u=>o.value.AppliesTags=u),convention:i.convention,organisation:i.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(_,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(ae,{onClick:v})]),_:1})]),_:1})]),_:1}))}}),Al=M({__name:"EditConventionInterests",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:w(["close"],["update:modelValue"]),setup(T,{emit:p}){const o=p,d=q(T,"modelValue"),v=B(),i=()=>{const t={ID:0,InterestUUID:$(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:d.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};v.saveInterest(t).then(a=>{a&&d.value.push(a)})},n=t=>{v.deleteInterest(d.value[t].InterestUUID).then(a=>{a&&d.value.splice(t,1)})},u=(...t)=>{t.forEach(a=>{a>=0&&a<d.value.length&&v.saveInterest(d.value[a])})};return(t,a)=>(c(),b(me,null,{default:l(()=>[e(ve,{dark:"",color:"primary"},{default:l(()=>[e(pe,null,{default:l(()=>a[1]||(a[1]=[N("Edit Interests")])),_:1}),e(ne),e(be,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>a[2]||(a[2]=[N(" Add ")])),_:1}),e(F,{icon:"",dark:"",onClick:a[0]||(a[0]=s=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[N("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(ye,{class:"pa-0"},{default:l(()=>[e(ce,null,{default:l(()=>[(c(!0),R(A,null,L(d.value,(s,f)=>(c(),b(Ve,{key:s.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:U})=>[e(ae,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:m=>n(f)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:U?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:Q(U=>{y(Ie)(s,d.value),u(f,f-1)},["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:Q(U=>{y(ge)(s,d.value),u(f,f+1)},["stop"])},null,8,["onClick"]),N(" "+P(s.Name)+" ",1)]),_:2},1024),e(De,{class:"px-0"},{default:l(()=>[e(_l,{convention:t.convention,modelValue:d.value[f],"onUpdate:modelValue":U=>d.value[f]=U},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Ol=M({__name:"Interests",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["refresh"],["update:modelValue"]),setup(T){const p=q(T,"modelValue"),o=B(),d=C([]);o.getConventionInterests(p.value.ConventionUUID).then(n=>{se(n),d.value=n});const v=C([""]),i=C(!1);return(n,u)=>(c(),R(A,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(_,null,{default:l(()=>[e(D,null,{default:l(()=>u[5]||(u[5]=[S("h3",null,"Interests",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(F,{color:"primary",onClick:u[0]||(u[0]=t=>i.value=!0)},{default:l(()=>u[6]||(u[6]=[N("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),u[7]||(u[7]=S("p",null,"Attendees can tag themselves for particular things.",-1)),e(xe,{opened:v.value,"onUpdate:opened":u[1]||(u[1]=t=>v.value=t)},{default:l(()=>[(c(!0),R(A,null,L(d.value,t=>(c(),b(de,{key:t.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${t.Name} ${t.Price&&t.Price>0?`(${y(h).currencySymbol}${t.Price})`:""}`},{default:l(()=>[t.Description?(c(),b(ue,{key:0},{default:l(()=>[N(P(t.Description),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(Ce,{modelValue:i.value,"onUpdate:modelValue":u[4]||(u[4]=t=>i.value=t),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(Al,{onClose:u[2]||(u[2]=t=>i.value=!1),convention:p.value,modelValue:d.value,"onUpdate:modelValue":u[3]||(u[3]=t=>d.value=t)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),ke=M({__name:"SelectTickets",props:w({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=v=>v.Type===G.TICKET_TYPE_GROUP?"mdi:mdi-group":v.Type===G.TICKET_TYPE_TICKET?v.RequiresAccommodation?"mdi:mdi-home":v.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":v.Type===G.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":v.Type===G.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",d=te(()=>T.tickets.map(v=>({title:v.Name,value:p.value.find(i=>i&&i.TicketUUID===v.TicketUUID)||v,props:{appendIcon:o(v)}})));return(v,i)=>(c(),R("div",null,[e(Je,{label:v.label,variant:v.variant||"filled",items:d.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=n=>p.value=n),hint:v.hint,chips:v.chips,clearable:v.clearable,multiple:"","persistent-hint":v.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Fl=M({__name:"EditConventionTicket",props:w({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=C(z(p.value)),d=B(),v=te(()=>T.tickets.filter(a=>a.Type===G.TICKET_TYPE_TICKET)),i=te(()=>T.tickets.filter(a=>a.Type===G.TICKET_TYPE_ADD_ON)),n=te(()=>T.tickets.filter(a=>a.Type===G.TICKET_TYPE_TICKET_COMPONENT)),u=a=>T.accommodation.filter(s=>s.Costs.find(f=>f.DateStart===a.DateStart&&f.DateEnd===a.DateEnd)),t=({callback:a})=>{d.saveTicket(o.value).then(s=>{s?(o.value.ID=s.ID,o.value.TicketUUID=s.TicketUUID,p.value=o.value,a&&a("Ticket Saved")):a&&a("Failed to Save Ticket")}).catch(()=>{a&&a("Failed to Save Ticket")})};return(a,s)=>(c(),b(j,{class:"px-0",fluid:""},{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Z,{label:"Ticket Type",variant:"outlined",modelValue:o.value.Type,"onUpdate:modelValue":s[0]||(s[0]=f=>o.value.Type=f),items:y(sl),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":s[1]||(s[1]=f=>o.value.Name=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":s[2]||(s[2]=f=>o.value.Description=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),o.value.Type!==y(G).TICKET_TYPE_GROUP?(c(),R(A,{key:0},[e(D,{cols:"12"},{default:l(()=>[e(H,{label:y(h).formLabelRequiresAccommodation,modelValue:o.value.RequiresAccommodation,"onUpdate:modelValue":s[3]||(s[3]=f=>o.value.RequiresAccommodation=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelDateStart,type:"date",variant:"outlined",modelValue:o.value.DateStart,"onUpdate:modelValue":s[4]||(s[4]=f=>o.value.DateStart=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelDateEnd,type:"date",variant:"outlined",modelValue:o.value.DateEnd,"onUpdate:modelValue":s[5]||(s[5]=f=>o.value.DateEnd=f),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":y(h).currencyIcon,modelValue:o.value.Price,"onUpdate:modelValue":s[6]||(s[6]=f=>o.value.Price=f),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(c(),b(D,{key:1,cols:"12"},{default:l(()=>[e(ke,{label:"Tickets",variant:"outlined",tickets:v.value,modelValue:o.value.Tickets,"onUpdate:modelValue":s[7]||(s[7]=f=>o.value.Tickets=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(D,{cols:"12"},{default:l(()=>[e(ee,{label:"Applied Tags",variant:"outlined",modelValue:o.value.AppliesTags,"onUpdate:modelValue":s[8]||(s[8]=f=>o.value.AppliesTags=f),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ee,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":s[9]||(s[9]=f=>o.value.RequiredTags=f),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Fe,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":s[10]||(s[10]=f=>o.value.RequiredGroupMemberships=f),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups (any one) that a user must be a member of to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),o.value.Type===y(G).TICKET_TYPE_TICKET?(c(),R(A,{key:2},[e(D,{cols:"12"},{default:l(()=>[e(O,{label:"Components Required",type:"number",variant:"outlined",modelValue:o.value.ComponentsRequired,"onUpdate:modelValue":s[11]||(s[11]=f=>o.value.ComponentsRequired=f),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ke,{label:"Components",variant:"outlined",tickets:n.value,modelValue:o.value.TicketComponents,"onUpdate:modelValue":s[12]||(s[12]=f=>o.value.TicketComponents=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ke,{label:"Addons",variant:"outlined",tickets:i.value,modelValue:o.value.AddonTickets,"onUpdate:modelValue":s[13]||(s[13]=f=>o.value.AddonTickets=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):x("",!0),e(D,{cols:"12"},{default:l(()=>[e(ke,{label:"Disables Tickets",variant:"outlined",tickets:a.tickets,modelValue:o.value.DisablesTickets,"onUpdate:modelValue":s[14]||(s[14]=f=>o.value.DisablesTickets=f),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),u(o.value).length?(c(),b(_,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>s[15]||(s[15]=[S("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1)])),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(Xe,null,{default:l(()=>[(c(!0),R(A,null,L(u(o.value),f=>(c(),b(Ke,{key:f.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[N(P(f.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):x("",!0),e(_,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(ae,{onClick:t})]),_:1})]),_:1})]),_:1}))}}),xl={class:"pr-2"},Ml={class:"mb-2"},Pl={key:0,class:"text-grey-darken-1 font-italic"},$l={key:1,class:"text-red"},wl={key:0,class:"text-grey-darken-1 font-italic"},ql={key:1,class:"text-red"},hl={key:0,class:"text-grey-darken-1 font-italic"},Ll={key:1,class:"text-red"},Gl={class:"text-grey-darken-1"},Kl=M({__name:"EditConventionTickets",props:w({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:w(["close"],["update:modelValue"]),setup(T,{emit:p}){const o=q(T,"modelValue"),d=p,v=B(),i=()=>{o.value.push({ID:0,TicketUUID:$(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:o.value.length+1,Name:"New Ticket",Type:G.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},n=t=>{v.deleteTicket(o.value[t].TicketUUID).then(a=>{a&&o.value.splice(t,1)})},u=t=>t.Type===G.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===G.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===G.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===G.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,a)=>(c(),b(me,null,{default:l(()=>[e(ve,{dark:"",color:"primary"},{default:l(()=>[e(pe,null,{default:l(()=>a[1]||(a[1]=[N("Edit Tickets")])),_:1}),e(ne),e(be,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>a[2]||(a[2]=[N(" Add Ticket ")])),_:1}),e(F,{icon:"",dark:"",onClick:a[0]||(a[0]=s=>d("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[N("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(ye,{class:"pa-0"},{default:l(()=>[e(ce,null,{default:l(()=>[(c(!0),R(A,null,L(o.value,(s,f)=>(c(),b(Ve,{key:s.ID,class:"mt-0"},{default:l(()=>[e(Ue,{class:"py-2"},{actions:l(({expanded:U})=>[e(ae,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:m=>n(f)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:U?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:Q(U=>y(Ie)(s,o.value),["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:Q(U=>y(ge)(s,o.value),["stop"])},null,8,["onClick"]),S("div",xl,[e(X,{icon:u(s)},null,8,["icon"])]),S("div",null,[S("p",Ml,[N(P(s.Name)+" ",1),s.Type===y(G).TICKET_TYPE_TICKET?(c(),R(A,{key:0},[o.value.find(U=>U.Type===y(G).TICKET_TYPE_GROUP&&U.Tickets.find(m=>m&&m.TicketUUID===s.TicketUUID))?(c(),R("span",Pl," ("+P(o.value.filter(U=>U.Type===y(G).TICKET_TYPE_GROUP&&U.Tickets.find(m=>m&&m.TicketUUID===s.TicketUUID)).map(U=>U.Name).join(", "))+") ",1)):(c(),R("span",$l," (Ticket does not belong to any categories.) "))],64)):x("",!0),s.Type===y(G).TICKET_TYPE_ADD_ON?(c(),R(A,{key:1},[o.value.find(U=>U.Type===y(G).TICKET_TYPE_TICKET&&U.AddonTickets.find(m=>m&&m.TicketUUID===s.TicketUUID))?(c(),R("span",wl," ("+P(o.value.filter(U=>U.Type===y(G).TICKET_TYPE_TICKET&&U.AddonTickets.find(m=>m&&m.TicketUUID===s.TicketUUID)).map(U=>U.Name).join(", "))+") ",1)):(c(),R("span",ql," (Ticket addon must be associated to at least one ticket.) "))],64)):x("",!0),s.Type===y(G).TICKET_TYPE_TICKET_COMPONENT?(c(),R(A,{key:2},[o.value.find(U=>U.Type===y(G).TICKET_TYPE_TICKET&&U.TicketComponents.find(m=>m&&m.TicketUUID===s.TicketUUID))?(c(),R("span",hl," ("+P(o.value.filter(U=>U.Type===y(G).TICKET_TYPE_TICKET&&U.TicketComponents.find(m=>m&&m.TicketUUID===s.TicketUUID)).map(U=>U.Name).join(", "))+") ",1)):(c(),R("span",Ll," (Component has not been assigned to any tickets.) "))],64)):x("",!0)]),S("p",Gl,[s.Type===y(G).TICKET_TYPE_GROUP?(c(),R(A,{key:0},[N("Category")],64)):s.Type===y(G).TICKET_TYPE_TICKET?(c(),R(A,{key:1},[a[4]||(a[4]=N(" Ticket ")),s.ComponentsRequired>0?(c(),R(A,{key:0},[N(" ("+P(s.ComponentsRequired)+" component"+P(s.ComponentsRequired>1?"s":"")+" required) ",1)],64)):x("",!0)],64)):x("",!0),s.Type===y(G).TICKET_TYPE_TICKET_COMPONENT?(c(),R(A,{key:2},[N("Component")],64)):x("",!0),s.Type===y(G).TICKET_TYPE_ADD_ON?(c(),R(A,{key:3},[N("Addon")],64)):x("",!0)])])]),_:2},1024),e(De,{class:"px-0"},{default:l(()=>[e(Fl,{accommodation:t.accommodation,convention:t.convention,tickets:o.value,modelValue:o.value[f],"onUpdate:modelValue":U=>o.value[f]=U},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Bl=M({__name:"Tickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["refresh"],["update:modelValue"]),setup(T){var f;const p=q(T,"modelValue"),o=B(),d=C([]),v=C([]);o.getConventionTickets(((f=p.value)==null?void 0:f.ConventionUUID)||"").then(U=>{se(U),d.value=U});const i=C([""]),n=C(!1),u=U=>U.AddonTickets&&U.AddonTickets.map(m=>d.value&&d.value.find(r=>r.ID===m.ID)),t=U=>U.TicketComponents&&U.TicketComponents.map(m=>d.value&&d.value.find(r=>r.ID===m.ID)),a=U=>"",s=U=>v.value.filter(m=>m.Costs.find(r=>r.DateStart===U.DateStart&&r.DateEnd===U.DateEnd)).map(m=>m.Name).join(", ");return(U,m)=>(c(),R(A,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(_,null,{default:l(()=>[e(D,null,{default:l(()=>m[5]||(m[5]=[S("h3",null,"Tickets",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(F,{color:"primary",onClick:m[0]||(m[0]=r=>n.value=!0)},{default:l(()=>m[6]||(m[6]=[N("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),m[7]||(m[7]=S("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1)),e(xe,{opened:i.value,"onUpdate:opened":m[1]||(m[1]=r=>i.value=r)},{default:l(()=>[(c(!0),R(A,null,L(d.value.filter(r=>r.Type===y(G).TICKET_TYPE_GROUP),r=>(c(),b($e,{key:r.ID,value:r.ID},{activator:l(({props:V})=>[e(de,Ne({ref_for:!0},V,{"prepend-icon":"mdi:mdi-group",title:r.Name}),null,16,["title"])]),default:l(()=>[(c(!0),R(A,null,L(d.value.filter(V=>r.Tickets.find(g=>g&&V&&g.TicketUUID===V.TicketUUID)),V=>(c(),R(A,{key:V.ID},[V.AddonTickets&&V.AddonTickets.length?(c(),b($e,{key:0,value:V.ID},{activator:l(({props:g})=>[e(de,Ne({ref_for:!0},g,{"prepend-icon":V.RequiresAccommodation?"mdi:mdi-home":V.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${V.Name} ${V.Price>0?`(${y(h).currencySymbol}${V.Price})`:""}`}),{default:l(()=>[V.ComponentsRequired>0?(c(),b(ue,{key:0},{default:l(()=>[N(" Options: "+P(t(V).map(k=>k&&k.Name).join(", ")),1)]),_:2},1024)):x("",!0),V.RequiresAccommodation&&s(V)?(c(),b(ue,{key:1},{default:l(()=>[N(" Accommodation: "+P(s(V)),1)]),_:2},1024)):x("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(c(!0),R(A,null,L(u(V),g=>(c(),R(A,{key:g},[g?(c(),b(de,{key:0,title:`${g.Name} ${g.Price>0?`(${y(h).currencySymbol}${g.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[g.RequiredTags&&g.RequiredTags.length>0?(c(),b(ue,{key:0},{default:l(()=>[N(" Required Tags: "+P(g.RequiredTags.join(", ")),1)]),_:2},1024)):x("",!0),g.RequiredGroupMemberships&&g.RequiredGroupMemberships.length>0?(c(),b(ue,{key:1},{default:l(()=>[N(" Required Groups: "+P(a(g.RequiredGroupMemberships)),1)]),_:2},1024)):x("",!0),s(g)?(c(),b(ue,{key:2},{default:l(()=>[N(" Accommodation: "+P(s(g)),1)]),_:2},1024)):x("",!0)]),_:2},1032,["title"])):x("",!0)],64))),128))]),_:2},1032,["value"])):(c(),b(de,{key:1,"prepend-icon":V.RequiresAccommodation?"mdi:mdi-home":V.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${V.Name} ${V.Price>0?`(${y(h).currencySymbol}${V.Price})`:""}`},{default:l(()=>[V.ComponentsRequired>0?(c(),b(ue,{key:0},{default:l(()=>[N(" Options: "+P(t(V).map(g=>g&&g.Name).join(", ")),1)]),_:2},1024)):x("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Ce,{modelValue:n.value,"onUpdate:modelValue":m[4]||(m[4]=r=>n.value=r),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(Kl,{onClose:m[2]||(m[2]=r=>n.value=!1),modelValue:d.value,"onUpdate:modelValue":m[3]||(m[3]=r=>d.value=r),accommodation:v.value,convention:p.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Yl=M({__name:"VenueRoomCost",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["deleted"],["update:modelValue"]),setup(T,{emit:p}){const o=p,d=q(T,"modelValue"),v=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],i=()=>{o("deleted")};return(n,u)=>(c(),b(_,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(O,{label:y(h).formLabelDateStart,type:"date",variant:"outlined",modelValue:d.value.DateStart,"onUpdate:modelValue":u[0]||(u[0]=t=>d.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(O,{label:y(h).formLabelDateEnd,type:"date",variant:"outlined",modelValue:d.value.DateEnd,"onUpdate:modelValue":u[1]||(u[1]=t=>d.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(O,{label:y(h).formLabelAvailability,type:"number",variant:"outlined",modelValue:d.value.Availability,"onUpdate:modelValue":u[2]||(u[2]=t=>d.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(O,{label:y(h).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:d.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>d.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(Z,{label:y(h).formLabelPriceType,variant:"outlined",modelValue:d.value.Type,"onUpdate:modelValue":u[4]||(u[4]=t=>d.value.Type=t),items:v,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(F,{color:"red",icon:"mdi:mdi-minus",onClick:i})]),_:1})]),_:1}))}}),Hl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},zl=M({__name:"VenueRoom",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["deleted"],["update:modelValue"]),setup(T,{emit:p}){const o=B(),d=p,v=C(h),i=q(T,"modelValue"),n=C(z(i.value)),u=C(!1),t=m=>{switch(m.Type){case Ae.PER_PERSON:return v.value.enumPER_PERSON;case Ae.PER_ROOM:return v.value.enumPER_ROOM}return"Unknown"},a=()=>{n.value.Costs||(n.value.Costs=[]),n.value.Costs.push({ID:0,CostUUID:$(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},s=m=>{n.value.Costs.splice(m,1)},f=({callback:m})=>{const r=()=>{m&&m("Failed to Delete Room")},V=()=>{m&&m("Room Deleted")};o.deleteRoom(n.value.RoomUUID).then(g=>{g?(V(),d("deleted",n.value)):r()}).catch(()=>{r()})},U=()=>{o.saveRoom(n.value).then(()=>{i.value=n.value,u.value=!1})};return(m,r)=>(c(),R(A,null,[e(j,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[S("h4",null,P(n.value.Name),1),S("p",null,P(n.value.Notes),1),S("p",null,[r[7]||(r[7]=S("strong",null,"Capacity:",-1)),N(" "+P(n.value.MinimumCapacity)+" ",1),n.value.MinimumCapacity!=n.value.MaximumCapacity?(c(),R(A,{key:0},[N(" - "+P(n.value.MaximumCapacity),1)],64)):x("",!0)]),e(rl,{density:"compact"},{default:l(()=>[r[8]||(r[8]=S("thead",null,[S("tr",null,[S("th",null,"Date"),S("th",null,"Price"),S("th",null,"Availability")])],-1)),S("tbody",null,[(c(!0),R(A,null,L(n.value.Costs,V=>(c(),R("tr",{key:`venue-room-${n.value.ID}-cost-${V.ID}`},[S("td",null,P(V.DateStart)+" - "+P(V.DateEnd),1),S("td",null,P(v.value.currencySymbol)+P(V.Price)+" "+P(t(V)),1),S("td",null,P(V.Availability),1)]))),128))])]),_:1}),S("div",Hl,[e(F,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:r[0]||(r[0]=V=>u.value=!0)},{default:l(()=>r[9]||(r[9]=[N("Edit Room")])),_:1}),e(ae,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:f},{default:l(()=>r[10]||(r[10]=[N("Delete Room")])),_:1})])]),_:1}),e(Ce,{scrollable:"",modelValue:u.value,"onUpdate:modelValue":r[6]||(r[6]=V=>u.value=V),width:"auto"},{default:l(()=>[e(me,null,{default:l(()=>[e(ve,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:r[1]||(r[1]=V=>u.value=!1)},{default:l(()=>[e(X,null,{default:l(()=>r[11]||(r[11]=[N("mdi:mdi-close")])),_:1})]),_:1}),e(pe,null,{default:l(()=>[N("Room Details ("+P(n.value.Name)+")",1)]),_:1}),e(ne),e(be,null,{default:l(()=>[e(F,{variant:"text",onClick:U},{default:l(()=>r[12]||(r[12]=[N(" Save ")])),_:1})]),_:1})]),_:1}),e(ye,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(O,{label:v.value.formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":r[2]||(r[2]=V=>n.value.Name=V)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,null,{default:l(()=>[e(fe,{label:v.value.formLabelNotes,variant:"outlined",modelValue:n.value.Notes,"onUpdate:modelValue":r[3]||(r[3]=V=>n.value.Notes=V)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{type:"number",label:v.value.formLabelMinimumCapacity,variant:"outlined",modelValue:n.value.MinimumCapacity,"onUpdate:modelValue":r[4]||(r[4]=V=>n.value.MinimumCapacity=V),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{type:"number",label:v.value.formLabelMaximumCapacity,variant:"outlined",modelValue:n.value.MaximumCapacity,"onUpdate:modelValue":r[5]||(r[5]=V=>n.value.MaximumCapacity=V),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,null,{default:l(()=>r[13]||(r[13]=[S("h4",null," Availability & Costs (To Organisation) ",-1)])),_:1})]),_:1}),(c(!0),R(A,null,L(n.value.Costs,(V,g)=>(c(),R(A,{key:`venue-room-${n.value.ID}-cost-${V.ID}`},[n.value.Costs&&n.value.Costs[g]?(c(),b(Yl,{key:0,modelValue:n.value.Costs[g],"onUpdate:modelValue":k=>n.value.Costs[g]=k,onDeleted:k=>s(g)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):x("",!0)],64))),128)),e(F,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:a},{default:l(()=>r[14]||(r[14]=[N("Add Row")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),jl=M({__name:"Venue",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["deleted"],["update:modelValue"]),setup(T,{emit:p}){const o=B(),d=p,v=q(T,"modelValue"),i=C(z(v.value)),n=C([]),u=C(!1),t=C(!1);o.getVenueRooms(i.value.VenueUUID).then(m=>{n.value=m}),le(i.value,()=>{t.value=!0});const a=({callback:m})=>{u.value=!0,o.saveVenue(i.value).then(()=>{u.value=!1,t.value=!1,v.value=i.value,m&&m("Venue Saved")}).catch(()=>{u.value=!1,m&&m("Failed to Saved Venue")})},s=({callback:m})=>{u.value=!0,o.deleteVenue(i.value.VenueUUID).then(r=>{u.value=!1,r?m&&(m("Venue Deleted"),d("deleted")):m&&m("Failed to Delete Venue")}).catch(()=>{m&&(m("Failed to Delete Venue"),u.value=!1)})},f=()=>{const m={ID:0,RoomUUID:$(),VenueID:i.value.ID,VenueUUID:i.value.VenueUUID,Order:n.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};o.saveRoom(m).then(r=>{r&&n.value.push(r)})},U=(m,r)=>{o.deleteRoom(n.value[r].RoomUUID).then(V=>{V&&n.value.splice(r,1)})};return(m,r)=>(c(),b(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[N(P(i.value.Name),1)]),_:1}),e(De,null,{default:l(()=>[e(_,{"no-gutters":""},{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(O,{label:y(h).formLabelName,name:"name",variant:"outlined",modelValue:i.value.Name,"onUpdate:modelValue":r[0]||(r[0]=V=>i.value.Name=V)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(fe,{label:y(h).formLabelDescription,name:"description",variant:"outlined",modelValue:i.value.Description,"onUpdate:modelValue":r[1]||(r[1]=V=>i.value.Description=V)},null,8,["label","modelValue"])]),_:1}),e(D,{class:"text-right",cols:"12"},{default:l(()=>[e(ae,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:s}),e(ae,{enabled:t.value,timeout:"7",onClick:a},null,8,["enabled"])]),_:1})]),_:1}),r[3]||(r[3]=S("h3",null,"Rooms",-1)),(c(!0),R(A,null,L(n.value,(V,g)=>(c(),b(oe,{variant:"elevation",elevation:"6",key:`venue-room-${V.ID}`},{default:l(()=>[n.value&&n.value[g]?(c(),b(zl,{key:0,modelValue:n.value[g],"onUpdate:modelValue":k=>n.value[g]=k,onDeleted:k=>U(k,g)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):x("",!0)]),_:2},1024))),128)),e(oe,{class:"ma-2"},{default:l(()=>[e(F,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:f},{default:l(()=>r[2]||(r[2]=[N("Add Room")])),_:1})]),_:1})]),_:1})]),_:1}))}}),Jl=M({__name:"VenuesEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["close","pageTitle","refresh"],["update:modelValue"]),setup(T,{emit:p}){const o=B(),d=p,v=q(T,"modelValue");d("pageTitle","Venues");const i=C([]);o.getConventionVenues(v.value.ConventionUUID).then(t=>{i.value=t});const n=()=>{const t={ID:0,VenueUUID:$(),ConventionID:v.value.ID,ConventionUUID:v.value.ConventionUUID,Order:i.value.length+1,Name:"New Venue",Description:"",Rooms:[]};o.saveVenue(t).then(a=>{a&&i.value.push(a)})},u=t=>{i.value.splice(t,1)};return(t,a)=>(c(),R(A,null,[e(j,{fluid:"",class:"px-0"},{default:l(()=>[e(_,null,{default:l(()=>[e(D,null,{default:l(()=>a[0]||(a[0]=[S("h3",null,"Venues",-1)])),_:1})]),_:1})]),_:1}),a[2]||(a[2]=S("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1)),a[3]||(a[3]=S("p",null," Attendee options are configured via the accommodation tab. ",-1)),e(oe,null,{default:l(()=>[e(ce,{variant:"accordion"},{default:l(()=>[(c(!0),R(A,null,L(i.value,(s,f)=>(c(),b(jl,{key:`venues-${s.ID}`,modelValue:i.value[f],"onUpdate:modelValue":U=>i.value[f]=U,onDeleted:U=>u(f)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(oe,{class:"pa-2"},{default:l(()=>[e(F,{color:"primary",onClick:n},{default:l(()=>a[1]||(a[1]=[N("Add Venue")])),_:1})]),_:1})]),_:1})],64))}}),Wl=M({__name:"AccommodationCost",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:w(["deleted"],["update:modelValue"]),setup(T,{emit:p}){const o=p,d=q(T,"modelValue"),v=C([]);B().getConventionTickets(T.convention.ConventionUUID).then(a=>{a&&(v.value=a)});const n=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],u=()=>{o("deleted")},t=te(()=>v.value.filter(a=>(a.Type===G.TICKET_TYPE_TICKET||a.Type===G.TICKET_TYPE_ADD_ON)&&a.RequiresAccommodation&&a.DateStart===d.value.DateStart&&a.DateEnd===d.value.DateEnd));return(a,s)=>(c(),R(A,null,[e(_,{class:"align-center",dense:""},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>s[4]||(s[4]=[S("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1)])),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(Xe,null,{default:l(()=>[(c(!0),R(A,null,L(t.value,f=>(c(),b(Ke,{key:f.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[N(P(f.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(_,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(O,{label:y(h).formLabelDateStart,type:"date",variant:"outlined",modelValue:d.value.DateStart,"onUpdate:modelValue":s[0]||(s[0]=f=>d.value.DateStart=f)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(O,{label:y(h).formLabelDateEnd,type:"date",variant:"outlined",modelValue:d.value.DateEnd,"onUpdate:modelValue":s[1]||(s[1]=f=>d.value.DateEnd=f)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(O,{label:y(h).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:d.value.Price,"onUpdate:modelValue":s[2]||(s[2]=f=>d.value.Price=f),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(Z,{label:y(h).formLabelPriceType,variant:"outlined",modelValue:d.value.Type,"onUpdate:modelValue":s[3]||(s[3]=f=>d.value.Type=f),items:n,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(F,{color:"red",icon:"mdi:mdi-minus",onClick:u})]),_:1})]),_:1})],64))}}),Xl=M({__name:"Accommodation",props:w({convention:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:w(["deleted"],["update:modelValue"]),setup(T,{emit:p}){const o=B(),d=p,v=q(T,"modelValue"),i=C(z(v.value)),n=te(()=>T.venues.map(f=>f.Rooms.map(U=>({title:` ${f.Name} - ${U.Name}`,value:U}))).flat()),u=()=>{i.value.Costs||(i.value.Costs=[]),i.value.Costs.push({ID:0,CostUUID:$(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:Ae.PER_ROOM})},t=f=>{i.value.Costs.splice(f,1)},a=({callback:f})=>{o.deleteAccommodation(i.value.AccommodationUUID).then(U=>{U?f&&(f("Accommodation Deleted"),d("deleted")):f&&f("Failed to Delete Accommodation")}).catch(()=>{f&&f("Failed to Delete Accommodation")})},s=({callback:f})=>{o.saveAccommodation(i.value).then(U=>{U?(i.value.ID=U.ID,v.value=U,f&&f("Accommodation Saved")):f&&f("Failed to Save Accommodation")}).catch(()=>{f&&f("Failed to Save Accommodation")})};return(f,U)=>(c(),b(oe,null,{default:l(()=>[e(_,null,{default:l(()=>[e(D,null,{default:l(()=>[e(O,{modelValue:i.value.Name,"onUpdate:modelValue":U[0]||(U[0]=m=>i.value.Name=m),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,null,{default:l(()=>[U[3]||(U[3]=S("h4",null," Room Pool ",-1)),U[4]||(U[4]=S("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1)),e(Z,{clearable:!0,modelValue:i.value.Pool,"onUpdate:modelValue":U[1]||(U[1]=m=>i.value.Pool=m),items:n.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),U[5]||(U[5]=S("p",null," Pool total: ",-1)),S("p",null,[e(ee,{label:"Required Tags",variant:"outlined",modelValue:i.value.RequiredTags,"onUpdate:modelValue":U[2]||(U[2]=m=>i.value.RequiredTags=m),convention:f.convention,organisation:f.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),U[6]||(U[6]=S("h4",null," Accommodation Costs ",-1)),U[7]||(U[7]=S("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1)),i.value.Costs?(c(!0),R(A,{key:0},L(i.value.Costs,(m,r)=>(c(),b(Wl,{key:`venue-room-${i.value.ID}-cost-${m.ID}`,convention:f.convention,modelValue:i.value.Costs[r],"onUpdate:modelValue":V=>i.value.Costs[r]=V,onDeleted:V=>t(r)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):x("",!0)]),_:1})]),_:1}),e(_,{"no-gutters":""},{default:l(()=>[e(D,{class:"text-left"},{default:l(()=>[e(F,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:u},{default:l(()=>U[8]||(U[8]=[N("Add Row")])),_:1})]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(ae,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:a}),e(ae,{onClick:s})]),_:1})]),_:1})]),_:1}))}}),Zl=M({__name:"AccommodationEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=B(),o=q(T,"modelValue"),d=C([]),v=C([]);p.getConventionAccommodation(o.value.ConventionUUID).then(t=>{t&&(d.value=t,se(d.value))}),p.getConventionVenues(o.value.ConventionUUID).then(t=>{t&&(v.value=t)});const i=()=>{const t={ID:0,AccommodationUUID:$(),ConventionID:o.value.ID,ConventionUUID:o.value.ConventionUUID,Order:d.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};p.saveAccommodation(t).then(a=>{a&&d.value.push(a)})},n=()=>{d.value.forEach(t=>{p.saveAccommodation(t)})},u=t=>{d.value.splice(t,1),se(d.value)};return(t,a)=>(c(),R(A,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(_,null,{default:l(()=>[e(D,null,{default:l(()=>a[0]||(a[0]=[S("h3",null,"Accommodation",-1)])),_:1})]),_:1})]),_:1}),a[3]||(a[3]=S("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1)),a[4]||(a[4]=S("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1)),e(oe,null,{default:l(()=>[e(ce,{variant:"accordion"},{default:l(()=>[(c(!0),R(A,null,L(d.value,(s,f)=>(c(),b(Ve,{key:s.AccommodationUUID},{default:l(()=>[e(Ue,null,{actions:l(({expanded:U})=>[e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:Q(m=>y(Ie)(s,d.value),["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-0",onClick:Q(m=>y(ge)(s,d.value),["stop"])},null,8,["onClick"]),e(X,{color:"teal",icon:U?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",size:"xx-large","aria-hidden":"true"},null,8,["color","icon"])]),default:l(()=>[N(P(s.Name)+" ",1)]),_:2},1024),e(De,null,{default:l(()=>[e(Xl,{convention:o.value,venues:v.value,modelValue:d.value[f],"onUpdate:modelValue":U=>d.value[f]=U,onDeleted:U=>u(f)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(oe,null,{default:l(()=>[e(j,{fluid:""},{default:l(()=>[e(_,null,{default:l(()=>[e(F,{color:"primary",onClick:i},{default:l(()=>a[1]||(a[1]=[N("Add Accommodation")])),_:1}),e(ne),e(F,{color:"success",onClick:n},{default:l(()=>a[2]||(a[2]=[N("Save Order")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}}),Ql=M({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=Oe.getInstance(),d=C([]),v=C([]);return o==null||o.getConventionExtras(p.value.ConventionUUID).then(i=>{d.value=i;const n=p.value.Values.find(u=>u.Title==="SelectedExtras");if(n)try{v.value=JSON.parse(n.Value)}catch{}}),le(v,()=>{const i=p.value.Values.find(n=>n.Title==="SelectedExtras");if(i)i.Value=JSON.stringify(v.value);else{const n={ID:0,FieldValueUUID:$(),FieldID:p.value.ID,FieldUUID:p.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(v.value)};p.value.Values.push(n)}}),(i,n)=>(c(!0),R(A,null,L(d.value,u=>(c(),b(H,{key:u.ExtraUUID,modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=t=>v.value=t),label:u.Name,value:u.ExtraUUID,name:p.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),et=M({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=Oe.getInstance(),d=C([]),v=C([]);return o==null||o.getConventionInterests(p.value.ConventionUUID).then(i=>{d.value=i;const n=p.value.Values.find(u=>u.Title==="SelectedInterests");if(n)try{v.value=JSON.parse(n.Value)}catch{}}),le(v,()=>{const i=p.value.Values.find(n=>n.Title==="SelectedInterests");if(i)i.Value=JSON.stringify(v.value);else{const n={ID:0,FieldValueUUID:$(),FieldID:p.value.ID,FieldUUID:p.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(v.value)};p.value.Values.push(n)}}),(i,n)=>(c(!0),R(A,null,L(d.value,u=>(c(),b(H,{key:u.InterestUUID,modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=t=>v.value=t),label:u.Name,value:u.InterestUUID,name:p.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),lt=M({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=Oe.getInstance(),d=C([]),v=C([]);return o==null||o.getConventionTickets(p.value.ConventionUUID).then(i=>{d.value=i;const n=p.value.Values.find(u=>u.Title==="SelectedTickets");if(n)try{v.value=JSON.parse(n.Value)}catch{}}),le(v,()=>{const i=p.value.Values.find(n=>n.Title==="SelectedTickets");if(i)i.Value=JSON.stringify(v.value);else{const n={ID:0,FieldValueUUID:$(),FieldID:p.value.ID,FieldUUID:p.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(v.value)};p.value.Values.push(n)}}),(i,n)=>(c(!0),R(A,null,L(d.value.filter(u=>u&&u.Type===y(G).TICKET_TYPE_GROUP),u=>(c(),b(H,{key:u.TicketUUID,modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=t=>v.value=t),label:u.Name,value:u.TicketUUID,name:p.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),tt=M({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=Oe.getInstance(),d=C([]),v=C(p.value.Values.map(u=>u.Value)),i=C({sharing:!1});try{const u=JSON.parse(p.value.Data);u&&(i.value=u)}catch{}const n=()=>{p.value.Data=JSON.stringify(i.value),p.value.Values=v.value.map(u=>{var t,a,s;return{ID:0,FieldValueUUID:$(),FieldID:((t=p.value)==null?void 0:t.ID)||0,FieldUUID:((a=p.value)==null?void 0:a.FieldUUID)||"",Title:((s=d.value.find(f=>f.AccommodationUUID==u))==null?void 0:s.Name)||"",Value:u}})};return o==null||o.getConventionAccommodation(p.value.ConventionUUID).then(u=>{u&&(d.value=u)}),(u,t)=>(c(),R(A,null,[t[2]||(t[2]=S("h5",null,"Display Options",-1)),e(H,{label:"Show Sharing Options",modelValue:i.value.sharing,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value.sharing=a),"hide-details":"",onChange:n},null,8,["modelValue"]),t[3]||(t[3]=S("h5",null,"Accommodation Choices",-1)),(c(!0),R(A,null,L(d.value,a=>(c(),b(H,{key:a.ID,modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),label:a.Name,value:a.AccommodationUUID,"hide-details":"",onChange:n},null,8,["modelValue","label","value"]))),128))],64))}}),at=M({__name:"EditFieldDialogAge",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){var s,f,U;const p=q(T,"modelValue"),o=new Date,d=o.getFullYear(),v=(o.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),i=o.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),n=C(parseInt(((s=p.value.Values.find(m=>m.Title==="MIN_AGE"))==null?void 0:s.Value)||"18")),u=C(((f=p.value.Values.find(m=>m.Title==="BEFORE_DATE"))==null?void 0:f.Value)||`${d}-${v}-${i}`),t=C(((U=p.value.Values.find(m=>m.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:U.Value)||""),a=()=>{var m,r,V,g,k,I;p.value.Values=[{ID:0,FieldValueUUID:$(),FieldID:((m=p.value)==null?void 0:m.ID)||0,FieldUUID:((r=p.value)==null?void 0:r.FieldUUID)||"",Title:"MIN_AGE",Value:n.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((V=p.value)==null?void 0:V.ID)||0,FieldUUID:((g=p.value)==null?void 0:g.FieldUUID)||"",Title:"BEFORE_DATE",Value:u.value},{ID:0,FieldValueUUID:$(),FieldID:((k=p.value)==null?void 0:k.ID)||0,FieldUUID:((I=p.value)==null?void 0:I.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:t.value}]};return a(),(m,r)=>(c(),b(j,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=V=>n.value=V),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:a},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=V=>u.value=V),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:a},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,null,{default:l(()=>[e(ee,{modelValue:t.value,"onUpdate:modelValue":r[2]||(r[2]=V=>t.value=V),convention:m.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${n.value} at time of data entry`,onChange:a},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),ot=M({__name:"EditFieldDialogHTML",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=C({html:""});try{const v=JSON.parse(p.value.Data);v&&(o.value=v)}catch{}const d=()=>{p.value.Data=JSON.stringify(o.value)};return(v,i)=>(c(),b(fe,{variant:"outlined",label:"Raw HTML",modelValue:o.value.html,"onUpdate:modelValue":i[0]||(i[0]=n=>o.value.html=n),onKeydown:d,onChange:d},null,8,["modelValue"]))}}),nt=M({__name:"EditFieldDialogBadgeImage",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=C({charge:0,free:0,height:0,label:!1,maximum:0,tags:[],use_browser:!1,use_queue:!1,width:0});try{o.value=ml(p.value.Data)}catch{}const d=()=>{p.value.Data=JSON.stringify(o.value)};return(v,i)=>(c(),R(A,null,[i[9]||(i[9]=S("h5",{class:"my-2"},"Tags & Labels",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(ee,{label:"Badge Tags",variant:"outlined",modelValue:o.value.tags,"onUpdate:modelValue":i[0]||(i[0]=n=>o.value.tags=n),convention:p.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that apply to this badge.","input-type":y(J).UUID_ARRAY,onChange:d},null,8,["modelValue","convention","input-type"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(H,{modelValue:o.value.label,"onUpdate:modelValue":i[1]||(i[1]=n=>o.value.label=n),label:"Allow Custom Label",variant:"outlined","hide-details":"",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),i[10]||(i[10]=S("h5",{class:"my-2"},"Dimensions",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:o.value.width,"onUpdate:modelValue":i[2]||(i[2]=n=>o.value.width=n),modelModifiers:{number:!0},label:"Width",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:d},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:o.value.height,"onUpdate:modelValue":i[3]||(i[3]=n=>o.value.height=n),modelModifiers:{number:!0},label:"Height",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),i[11]||(i[11]=S("h5",{class:"my-2"},"Limits",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:o.value.maximum,"onUpdate:modelValue":i[4]||(i[4]=n=>o.value.maximum=n),modelModifiers:{number:!0},label:"Maximum Badges",hint:"Zero = Unlimited",variant:"outlined",type:"number",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),i[12]||(i[12]=S("h5",{class:"my-2"},"Costs",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:o.value.charge,"onUpdate:modelValue":i[5]||(i[5]=n=>o.value.charge=n),modelModifiers:{number:!0},label:"Charge Per Badge",prefix:y(h).currencySymbol,variant:"outlined","hide-details":"",type:"number",min:"0",onChange:d},null,8,["modelValue","prefix"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:o.value.free,"onUpdate:modelValue":i[6]||(i[6]=n=>o.value.free=n),modelModifiers:{number:!0},label:"Free Badges",variant:"outlined","hide-details":"",type:"number",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),i[13]||(i[13]=S("h5",{class:"my-2"},"Processing",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(H,{modelValue:o.value.use_browser,"onUpdate:modelValue":i[7]||(i[7]=n=>o.value.use_browser=n),modelModifiers:{number:!0},label:"Use Browser Image Processing",variant:"outlined","hide-details":"",onChange:d},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(H,{modelValue:o.value.use_queue,"onUpdate:modelValue":i[8]||(i[8]=n=>o.value.use_queue=n),modelModifiers:{number:!0},label:"Use Server Side Image Queue for Processing",variant:"outlined","hide-details":"",onChange:d},null,8,["modelValue"])]),_:1})]),_:1})],64))}}),ut=M({__name:"EditFieldDialogConfirmation",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){var u,t,a,s;const p=q(T,"modelValue"),o=C(((u=p.value.Values.find(f=>f.Title==="MATCH_STRING"))==null?void 0:u.Value)||""),d=C(((t=p.value.Values.find(f=>f.Title==="CASE_SENSITIVE"))==null?void 0:t.Value)=="true"||!1),v=C(((a=p.value.Values.find(f=>f.Title==="MUST_MATCH"))==null?void 0:a.Value)=="true"||!1),i=C(((s=p.value.Values.find(f=>f.Title==="MATCHED_APPLY_TAGS"))==null?void 0:s.Value)||""),n=()=>{var f,U,m,r,V,g,k,I;p.value.Values=[{ID:0,FieldValueUUID:$(),FieldID:((f=p.value)==null?void 0:f.ID)||0,FieldUUID:((U=p.value)==null?void 0:U.FieldUUID)||"",Title:"MATCH_STRING",Value:o.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((m=p.value)==null?void 0:m.ID)||0,FieldUUID:((r=p.value)==null?void 0:r.FieldUUID)||"",Title:"CASE_SENSITIVE",Value:d.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((V=p.value)==null?void 0:V.ID)||0,FieldUUID:((g=p.value)==null?void 0:g.FieldUUID)||"",Title:"MUST_MATCH",Value:v.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((k=p.value)==null?void 0:k.ID)||0,FieldUUID:((I=p.value)==null?void 0:I.FieldUUID)||"",Title:"MATCHED_APPLY_TAGS",Value:i.value}]};return n(),(f,U)=>(c(),b(j,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:o.value,"onUpdate:modelValue":U[0]||(U[0]=m=>o.value=m),type:"text",label:"Text that must be entered","hide-details":"",variant:"outlined",onChange:n},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(ee,{modelValue:i.value,"onUpdate:modelValue":U[1]||(U[1]=m=>i.value=m),convention:f.convention,chips:!0,clearable:!0,variant:"outlined",label:"Tags applied to users that entered the correct text",onChange:n},null,8,["modelValue","convention"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(H,{modelValue:d.value,"onUpdate:modelValue":U[2]||(U[2]=m=>d.value=m),label:"Case sensitive","hide-details":"",variant:"outlined",onChange:n},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(H,{modelValue:v.value,"onUpdate:modelValue":U[3]||(U[3]=m=>v.value=m),label:"Field must match text to proceed","hide-details":"",variant:"outlined",onChange:n},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}}),it={key:0},dt={key:1},st=M({__name:"EditFieldDialog",props:w({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:w(["update:field"],["update:modelValue"]),setup(T,{emit:p}){const o=T,{convention:d,title:v=""}=o,i=p,n=q(T,"modelValue"),u=re(o,i,void 0,void 0,"field"),t=C(z(u.value)),a=C(""),s=C(t.value.Type);le(u,()=>{t.value=z(u.value)});const f=()=>{n.value=!1},U=()=>{t.value=z(u.value)},m=()=>{u.value=t.value},r=()=>{t.value.Values.push({ID:0,FieldValueUUID:$(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},V=k=>{t.value.Values.splice(k,1)},g=()=>{a.value="",t.value.Values=[]};return le(s,(k,I)=>{k!==I&&(t.value.Type=k,g())}),(k,I)=>(c(),b(Ye,{modelValue:n.value,"onUpdate:modelValue":I[17]||(I[17]=E=>n.value=E),onReset:U,onSave:m,title:y(v),color:"primary",persistent:!0,fullscreen:!0},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:t.value.Name,"onUpdate:modelValue":I[0]||(I[0]=E=>t.value.Name=E),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:t.value.Label,"onUpdate:modelValue":I[1]||(I[1]=E=>t.value.Label=E),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:t.value.Hint,"onUpdate:modelValue":I[2]||(I[2]=E=>t.value.Hint=E),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(O,{modelValue:t.value.Placeholder,"onUpdate:modelValue":I[3]||(I[3]=E=>t.value.Placeholder=E),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(Z,{modelValue:s.value,"onUpdate:modelValue":I[4]||(I[4]=E=>s.value=E),label:"Type",variant:"outlined",items:y(Ze),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===y(Y).SELECT||t.value.Type===y(Y).CHECKBOX||t.value.Type===y(Y).BADGE_IMAGE?(c(),b(D,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[t.value.Type===y(Y).SELECT||t.value.Type===y(Y).CHECKBOX?(c(),b(H,{key:0,modelValue:t.value.Multiple,"onUpdate:modelValue":I[5]||(I[5]=E=>t.value.Multiple=E),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"])):t.value.Type===y(Y).BADGE_IMAGE?(c(),b(H,{key:1,modelValue:t.value.Multiple,"onUpdate:modelValue":I[6]||(I[6]=E=>t.value.Multiple=E),label:"Custom Fields",hint:"Enable additional badge fields","hide-details":""},null,8,["modelValue"])):x("",!0),t.value.Type===y(Y).SELECT?(c(),b(H,{key:2,modelValue:t.value.Autofill,"onUpdate:modelValue":I[7]||(I[7]=E=>t.value.Autofill=E),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):x("",!0)]),_:1})):x("",!0)]),_:1}),t.value.Type===y(Y).BADGE_IMAGE?(c(),b(_,{key:0},{default:l(()=>[e(D,null,{default:l(()=>[I[18]||(I[18]=S("h4",null,"Badge Image Options",-1)),e(nt,{modelValue:t.value,"onUpdate:modelValue":I[8]||(I[8]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):x("",!0),t.value.Type===y(Y).SELECT||t.value.Type===y(Y).CHECKBOX&&t.value.Multiple||t.value.Type===y(Y).RADIO||t.value.Type===y(Y).BADGE_IMAGE&&t.value.Multiple?(c(),b(_,{key:1},{default:l(()=>[e(D,null,{default:l(()=>[t.value.Type===y(Y).BADGE_IMAGE?(c(),R("h4",it,"Custom Fields")):(c(),R("h4",dt,"Values")),e(j,{fluid:!0,class:"px-0"},{default:l(()=>[(c(!0),R(A,null,L(t.value.Values,(E,K)=>(c(),b(_,{key:E.ID},{default:l(()=>[e(D,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(O,{modelValue:E.Title,"onUpdate:modelValue":W=>E.Title=W,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(O,{modelValue:E.Value,"onUpdate:modelValue":W=>E.Value=W,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(F,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:W=>V(K)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(_,null,{default:l(()=>[e(D,null,{default:l(()=>[e(F,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:r},{default:l(()=>I[19]||(I[19]=[N("Add Item")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===y(Y).ACCOMMODATION?(c(),b(_,{key:2},{default:l(()=>[e(D,null,{default:l(()=>[I[20]||(I[20]=S("h4",null,"Accommodation",-1)),e(tt,{modelValue:t.value,"onUpdate:modelValue":I[9]||(I[9]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).AGE?(c(),b(_,{key:3},{default:l(()=>[e(D,null,{default:l(()=>[I[21]||(I[21]=S("h4",null,"Age",-1)),e(at,{modelValue:t.value,"onUpdate:modelValue":I[10]||(I[10]=E=>t.value=E),convention:y(d)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===y(Y).CONFIRMATION?(c(),b(_,{key:4},{default:l(()=>[e(D,null,{default:l(()=>[I[22]||(I[22]=S("h4",null,"Confirmation Field",-1)),e(ut,{modelValue:t.value,"onUpdate:modelValue":I[11]||(I[11]=E=>t.value=E),convention:y(d)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===y(Y).EXTRAS?(c(),b(_,{key:5},{default:l(()=>[e(D,null,{default:l(()=>[I[23]||(I[23]=S("h4",null,"Additional Purchases",-1)),e(Ql,{modelValue:t.value,"onUpdate:modelValue":I[12]||(I[12]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).HTML?(c(),b(_,{key:6},{default:l(()=>[e(D,null,{default:l(()=>[e(ot,{modelValue:t.value,"onUpdate:modelValue":I[13]||(I[13]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).INTERESTS?(c(),b(_,{key:7},{default:l(()=>[e(D,null,{default:l(()=>[I[24]||(I[24]=S("h4",null,"Available Interests",-1)),e(et,{modelValue:t.value,"onUpdate:modelValue":I[14]||(I[14]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).TICKET?(c(),b(_,{key:8},{default:l(()=>[e(D,null,{default:l(()=>[I[25]||(I[25]=S("h4",null,"Tickets",-1)),e(lt,{modelValue:t.value,"onUpdate:modelValue":I[15]||(I[15]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):x("",!0)]),_:1})]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(oe,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[I[26]||(I[26]=S("h4",{class:"mb-3"},"Field Preview",-1)),e(Qe,{admin:!0,field:t.value,convention:y(d),modelValue:a.value,"onUpdate:modelValue":I[16]||(I[16]=E=>a.value=E)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(F,{color:"blue-darken-1",variant:"text",onClick:f},{default:l(()=>I[27]||(I[27]=[N(" Cancel ")])),_:1}),e(F,{color:"blue-darken-1",variant:"text",onClick:U},{default:l(()=>I[28]||(I[28]=[N(" Reset ")])),_:1}),e(ne),e(F,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>I[29]||(I[29]=[N(" Save ")])),_:1})]),_:1},8,["modelValue","title"]))}}),rt=M({__name:"FieldEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["refresh"],["update:modelValue"]),setup(T){const p=q(T,"modelValue"),o=B(),d=C(!1),v=C(!1),i=C([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),n=C([]);o.getConventionFields(p.value.ConventionUUID).then(E=>{E&&(n.value=E)});const u=C(-1),t=C({ID:0,FieldUUID:$(),ConventionID:p.value.ID,ConventionUUID:p.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),a=te(()=>u.value===-1?"New Field":"Edit Field"),s=()=>({ID:0,FieldUUID:$(),ConventionID:p.value.ID,ConventionUUID:p.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),f=C(s()),U=()=>{f.value.FieldUUID=$(),t.value=Object.assign({},s()),u.value=-1,d.value=!0},m=E=>{u.value=n.value.indexOf(E),t.value=Object.assign({},E),d.value=!0},r=E=>{u.value=n.value.indexOf(E),t.value=Object.assign({},E),v.value=!0},V=()=>{o.deleteField(t.value.FieldUUID).then(E=>{E&&(n.value.splice(u.value,1),k())})},g=()=>{d.value=!1,Se(()=>{t.value=Object.assign({},f.value),u.value=-1})},k=()=>{v.value=!1,Se(()=>{t.value=Object.assign({},f.value),u.value=-1})},I=()=>{o.saveField(t.value).then(E=>{E&&(u.value>-1?Object.assign(n.value[u.value],E):n.value.push(E),g())})};return(E,K)=>(c(),b(el,{headers:i.value,items:n.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ve,{color:"primary"},{default:l(()=>[e(pe,null,{default:l(()=>K[3]||(K[3]=[N("Field Editor")])),_:1}),e(We,{class:"mx-4",inset:!0,vertical:!0}),e(ne),e(F,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:U},{default:l(()=>K[4]||(K[4]=[N(" New Item ")])),_:1}),e(Be,{modelValue:v.value,"onUpdate:modelValue":K[0]||(K[0]=W=>v.value=W),onDelete:V},null,8,["modelValue"])]),_:1}),d.value?(c(),b(st,{key:0,modelValue:d.value,"onUpdate:modelValue":K[1]||(K[1]=W=>d.value=W),field:t.value,"onUpdate:field":[K[2]||(K[2]=W=>t.value=W),I],title:a.value,convention:p.value},null,8,["modelValue","field","title","convention"])):x("",!0)]),"item.actions":l(({item:W})=>[e(X,{size:"small",class:"me-2",onClick:nl=>m(W)},{default:l(()=>K[5]||(K[5]=[N(" mdi:mdi-pencil ")])),_:2},1032,["onClick"]),e(X,{size:"small",onClick:nl=>r(W)},{default:l(()=>K[6]||(K[6]=[N(" mdi:mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),mt=(T,p)=>{const o=re(T,p),d=re(T,p,void 0,void 0,"item"),v=C(z(d.value));return le(d,()=>{v.value=z(d.value)}),{state:o,model:d,close:()=>{o.value=!1},reset:()=>{d.value=z(v.value)},save:()=>{p("save")}}},vt=M({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(T,{emit:p}){const o=T,d=p,{state:v,close:i,reset:n,save:u}=mt(o,d);return(t,a)=>(c(),b(Ye,{modelValue:y(v),"onUpdate:modelValue":a[0]||(a[0]=s=>Ee(v)?v.value=s:null),onReset:y(n),onSave:y(u),title:t.title,color:"primary","card-class":t.cardClass,fullscreen:!0,persistent:!0},{toolbarButtons:l(()=>[Pe(t.$slots,"toolbarButtons")]),actions:l(()=>[e(F,{color:"blue-darken-1",variant:"text",onClick:y(i)},{default:l(()=>a[1]||(a[1]=[N(" Cancel ")])),_:1},8,["onClick"]),e(F,{color:"blue-darken-1",variant:"text",onClick:y(n)},{default:l(()=>a[2]||(a[2]=[N(" Reset ")])),_:1},8,["onClick"]),e(ne),e(F,{color:"blue-darken-1",variant:"text",onClick:y(u)},{default:l(()=>a[3]||(a[3]=[N(" Save ")])),_:1},8,["onClick"])]),default:l(()=>[Pe(t.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),pt={class:"pa-0 border-0 ma-0"},ft={class:"pa-0 border-0 ma-0"},ct=M({__name:"EditFormField",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=B(),d=C([]),v=C([]),i=C(""),n=u=>{var t;p.value.Field=(t=v.value.find(a=>a.value===u))==null?void 0:t.field};return o.getConventionFields(T.convention.ConventionUUID).then(u=>{u&&(d.value=u,v.value=u.map(t=>({title:`${t.Label} (${(Ze.find(a=>a.value===t.Type)||{title:""}).title})`,value:t.FieldUUID,field:t})),n(p.value.FieldUUID))}),(u,t)=>(c(),b(_,null,{default:l(()=>[e(D,{cols:"12",md:"6"},{default:l(()=>[S("fieldset",pt,[t[5]||(t[5]=S("legend",{class:"mb-2"},"Field Settings",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:p.value.FieldUUID,"onUpdate:modelValue":[t[0]||(t[0]=a=>p.value.FieldUUID=a),n],items:v.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(O,{modelValue:p.value.MinLength,"onUpdate:modelValue":t[1]||(t[1]=a=>p.value.MinLength=a),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(O,{modelValue:p.value.MaxLength,"onUpdate:modelValue":t[2]||(t[2]=a=>p.value.MaxLength=a),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"4"},{default:l(()=>[e(H,{modelValue:p.value.Required,"onUpdate:modelValue":t[3]||(t[3]=a=>p.value.Required=a),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),p.value.FieldUUID&&p.value.Field?(c(),b(D,{key:0,cols:"12",md:"6"},{default:l(()=>[S("fieldset",ft,[t[6]||(t[6]=S("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1)),p.value.Field?(c(),b(Qe,{key:0,admin:!0,field:p.value.Field,"persistent-hint":!0,required:p.value.Required,convention:u.convention,modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=a=>i.value=a)},null,8,["field","required","convention","modelValue"])):x("",!0)])]),_:1})):x("",!0)]),_:1}))}}),Vt={class:"d-none d-sm-block"},Ut=M({__name:"EditFormSectionFields",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=()=>{var d;return{ID:0,SectionFieldUUID:$(),SectionID:p.value.ID,SectionUUID:p.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((d=p.value.Fields)==null?void 0:d.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(d,v)=>p.value.Fields!==void 0?(c(),b(ll,{key:0,modelValue:p.value.Fields,"onUpdate:modelValue":v[0]||(v[0]=i=>p.value.Fields=i),closeable:!1,title:"Fields","new-item":o,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Te({_:2},[L(p.value.Fields,(i,n)=>({name:`field_${n}_title`,fn:l(()=>[i.Field?(c(),R(A,{key:0},[N(P(i.Field.Label)+" ("+P(i.Field.Name)+") ",1),S("template",Vt,[N(" ["+P(i.Field.Type)+"] ",1)])],64)):(c(),R(A,{key:1},[N("New Field")],64))])})),L(p.value.Fields,(i,n)=>({name:`field_${n}`,fn:l(()=>[e(ct,{modelValue:p.value.Fields[n],"onUpdate:modelValue":u=>p.value.Fields[n]=u,convention:d.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):x("",!0)}}),Dt=M({__name:"EditFormSections",props:w({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const p=q(T,"modelValue"),o=()=>{const d={ID:0,SectionUUID:$(),FormID:p.value.ID,FormUUID:p.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:$(),SectionID:0,SectionUUID:"",Edit:!0},RequiredTags:[],RequiredGroupMemberships:[]};return d.State.SectionID=d.ID,d.State.SectionUUID=d.SectionUUID,d};return(d,v)=>(c(),b(ll,{modelValue:p.value.Sections,"onUpdate:modelValue":v[0]||(v[0]=i=>p.value.Sections=i),"new-item":o,closeable:!1,title:"Sections","slot-name-prefix":"section"},Te({_:2},[L(p.value.Sections,(i,n)=>({name:`section_${n}`,fn:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{modelValue:i.Name,"onUpdate:modelValue":u=>i.Name=u,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{modelValue:i.Heading,"onUpdate:modelValue":u=>i.Heading=u,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(fe,{modelValue:i.Description,"onUpdate:modelValue":u=>i.Description=u,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(ee,{label:"Required Tags",variant:"outlined",modelValue:i.RequiredTags,"onUpdate:modelValue":u=>i.RequiredTags=u,convention:d.convention,organisation:d.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention","organisation"])]),_:2},1024)]),_:2},1024),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Fe,{label:"Required Groups",variant:"outlined",modelValue:i.RequiredGroupMemberships,"onUpdate:modelValue":u=>i.RequiredGroupMemberships=u,convention:d.convention,organisation:d.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention","organisation"])]),_:2},1024)]),_:2},1024),i.Fields?(c(),b(Ut,{key:0,modelValue:p.value.Sections[n],"onUpdate:modelValue":u=>p.value.Sections[n]=u,convention:d.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):x("",!0)])}))]),1032,["modelValue"]))}}),Tt=M({__name:"FormRendererPopup",props:w({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:w(["update:form"],["update:modelValue"]),setup(T,{emit:p}){const o=T,{admin:d=!1,convention:v,title:i="",cardClass:n=""}=o,u=p,t=q(T,"modelValue"),a=re(o,u,void 0,void 0,"form"),s=C(z(a.value));le(a,()=>{s.value=z(a.value)});const f=()=>{t.value=!1};return(U,m)=>(c(),b(Ye,{modelValue:t.value,"onUpdate:modelValue":m[1]||(m[1]=r=>t.value=r),title:y(i),color:"primary","card-class":y(n),fullscreen:!0,scrollable:!0},{toolbarButtons:l(()=>[Pe(U.$slots,"toolbarButtons")]),actions:l(()=>[e(F,{color:"blue-darken-1",variant:"text",onClick:f},{default:l(()=>m[2]||(m[2]=[N(" Close ")])),_:1})]),default:l(()=>[e(vl,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=r=>s.value=r),admin:y(d),convention:y(v),preview:U.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),It=M({__name:"EditFormDialog",props:w({convention:{},form:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:w(["update:form"],["update:modelValue"]),setup(T,{emit:p}){const o=T,{convention:d}=o,v=q(T,"modelValue"),i=p,n=B(),u=re(o,i,void 0,void 0,"form"),t=C(!1),a=C(z(u.value));le(u,()=>{a.value=z(u.value)});const s=()=>{n.saveForm(a.value).then(U=>{U&&(u.value=U,v.value=!1)})},f=()=>{t.value=!0};return(U,m)=>(c(),b(vt,{modelValue:v.value,"onUpdate:modelValue":m[14]||(m[14]=r=>v.value=r),item:a.value,"onUpdate:item":m[15]||(m[15]=r=>a.value=r),onSave:s,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(Vl,null,{default:l(()=>[e(F,{"prepend-icon":"mdi:mdi-developer-board",onClick:f},{default:l(()=>m[16]||(m[16]=[S("template",{class:"d-none d-sm-inline"},[N("Preview")],-1)])),_:1})]),_:1})]),default:l(()=>[e(ce,null,{default:l(()=>[e(Ve,{class:"mt-0"},{default:l(()=>[e(Ue,null,{default:l(()=>m[17]||(m[17]=[N("General Settings")])),_:1}),e(De,null,{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(_,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{modelValue:a.value.Name,"onUpdate:modelValue":m[0]||(m[0]=r=>a.value.Name=r),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{modelValue:a.value.Heading,"onUpdate:modelValue":m[1]||(m[1]=r=>a.value.Heading=r),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(fe,{modelValue:a.value.Description,"onUpdate:modelValue":m[2]||(m[2]=r=>a.value.Description=r),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(Z,{modelValue:a.value.Type,"onUpdate:modelValue":m[3]||(m[3]=r=>a.value.Type=r),label:"Type",variant:"outlined",items:y(pl),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(O,{modelValue:a.value.NotificationEmail,"onUpdate:modelValue":m[4]||(m[4]=r=>a.value.NotificationEmail=r),label:"Notification Email",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",class:"d-none"},{default:l(()=>[e(O,{modelValue:a.value.State.Stage,"onUpdate:modelValue":m[5]||(m[5]=r=>a.value.State.Stage=r),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(H,{modelValue:a.value.State.New,"onUpdate:modelValue":m[6]||(m[6]=r=>a.value.State.New=r),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(H,{modelValue:a.value.State.Edit,"onUpdate:modelValue":m[7]||(m[7]=r=>a.value.State.Edit=r),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(H,{modelValue:a.value.State.Independent,"onUpdate:modelValue":m[8]||(m[8]=r=>a.value.State.Independent=r),label:"Independent of Registration Form"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(ee,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":m[9]||(m[9]=r=>a.value.RequiredTags=r),convention:y(d),organisation:y(d).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Fe,{label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":m[10]||(m[10]=r=>a.value.RequiredGroupMemberships=r),convention:y(d),organisation:y(d).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a.value?(c(),b(Dt,{key:0,modelValue:a.value,"onUpdate:modelValue":m[11]||(m[11]=r=>a.value=r),convention:y(d),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):x("",!0),t.value?(c(),b(Tt,{key:1,modelValue:t.value,"onUpdate:modelValue":m[12]||(m[12]=r=>t.value=r),form:a.value,"onUpdate:form":m[13]||(m[13]=r=>a.value=r),admin:!0,convention:y(d),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):x("",!0)]),_:1},8,["modelValue","item"]))}}),gt=(T,p)=>{const o=C(!1),d=C(!1),v=C(T),i=C(-1),n=C(p),u=C(p),t=te(()=>i.value===-1?"New Form":"Edit Form"),a=()=>{v.value=T},s=g=>{i.value=v.value.indexOf(g),n.value=Object.assign({},g),o.value=!0},f=g=>{i.value=v.value.indexOf(g),n.value=Object.assign({},g),d.value=!0},U=()=>{d.value=!1,Se(()=>{n.value=Object.assign({},u.value),i.value=-1}).then()},m=()=>{v.value.splice(i.value,1),U()},r=()=>{o.value=!1,Se(()=>{n.value=Object.assign({},u.value),i.value=-1}).then()},V=()=>{i.value>-1?Object.assign(v.value[i.value],n.value):v.value.push(n.value),r()};return le(o,g=>{g||r()}),le(d,g=>{g||U()}),{collection:v,defaultItem:u,dialog:o,dialogDelete:d,editedItem:n,formTitle:t,reset:a,editItem:s,deleteItem:f,deleteItemConfirm:m,close:r,save:V}},yt=M({__name:"FormEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:w(["refresh"],["update:modelValue"]),setup(T){const p=q(T,"modelValue"),o=B(),d=C([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),v=C([]),i=C([]);o.getConventionFields(p.value.ConventionUUID).then(k=>{v.value=k}),o.getConventionForms(p.value.ConventionUUID).then(k=>{i.value=k});const n={ID:0,FormUUID:$(),ConventionID:p.value.ID,ConventionUUID:p.value.ConventionUUID,ParentID:0,ParentUUID:Re,Name:"",Heading:"",Description:"",Type:fl.FORM_TYPE_ADDITIONAL,Sections:[],State:{ID:0,FormStateUUID:$(),FormID:0,FormUUID:Re,New:!1,Edit:!1,Stage:0,Independent:!1},RequiredGroupMemberships:[],RequiredTags:[],NotificationEmail:""};n.State.FormUUID=n.FormUUID;const{collection:u,defaultItem:t,dialog:a,dialogDelete:s,editedItem:f,editItem:U,deleteItem:m,deleteItemConfirm:r,save:V}=gt(i,n);u.value.forEach(k=>{k.Sections.forEach(I=>{var E;(E=I.Fields)==null||E.forEach(K=>{K.Field=v.value.find(W=>W.ID===K.FieldID)})})});const g=k=>{o.deleteForm(k.FormUUID).then(I=>{I&&m(k)})};return(k,I)=>(c(),b(el,{headers:d.value,items:y(u),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ve,{color:"primary"},{default:l(()=>[e(pe,null,{default:l(()=>I[4]||(I[4]=[N("Form Editor")])),_:1}),e(We,{class:"mx-4",inset:!0,vertical:!0}),e(ne),e(F,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:I[0]||(I[0]=E=>{f.value=Object.assign({},y(t)),a.value=!0})},{default:l(()=>I[5]||(I[5]=[N(" New Item ")])),_:1}),e(Be,{modelValue:y(s),"onUpdate:modelValue":I[1]||(I[1]=E=>Ee(s)?s.value=E:null),onDelete:y(r)},null,8,["modelValue","onDelete"])]),_:1}),y(a)?(c(),b(It,{key:0,title:y(f).Name?`Edit Form - ${y(f).Name}`:"Create New Form",modelValue:y(a),"onUpdate:modelValue":I[2]||(I[2]=E=>Ee(a)?a.value=E:null),form:y(f),"onUpdate:form":[I[3]||(I[3]=E=>Ee(f)?f.value=E:null),y(V)],convention:p.value},null,8,["title","modelValue","form","onUpdate:form","convention"])):x("",!0)]),"item.actions":l(({item:E})=>[e(X,{size:"small",class:"me-2",onClick:K=>y(U)(E)},{default:l(()=>I[6]||(I[6]=[N(" mdi:mdi-pencil ")])),_:2},1032,["onClick"]),e(X,{size:"small",onClick:K=>g(E)},{default:l(()=>I[7]||(I[7]=[N(" mdi:mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),bt=M({__name:"LinkedFields",props:{convention:{}},emits:["update:convention"],async setup(T,{emit:p}){let o,d;const v=T,{getLinkedFields:i,saveLinkedFields:n,linkedFieldsKey:u}=cl(),a=re(v,p,void 0,void 0,"convention"),s=C(([o,d]=_e(()=>i(a.value.ConventionUUID)),o=await o,d(),o)),f=C(!1),U=async()=>{try{f.value=!0,s.value&&await n(a.value.ConventionUUID,s.value)}catch(V){console.error(V)}f.value=!1},m=C([]),r=([o,d]=_e(()=>Dl(a.value.ConventionUUID)),o=await o,d(),o);return r&&(r.forEach(V=>V.Sections.forEach(g=>g.Fields&&m.value.push(...g.Fields.map(k=>{var E;return{title:`${V.Name} - ${g.Name} - ${(E=k.Field)==null?void 0:E.Name}`,value:k.SectionFieldUUID,object:k}})))),m.value.sort(dl("title"))),(V,g)=>(c(),b(He,{method:"post",action:`/api/convention/${y(a).ConventionUUID}/config/${y(u)}`,onSubmit:Q(U,["prevent"]),class:"pa-sm-4"},{default:l(()=>[g[6]||(g[6]=S("h2",null,"Linked Fields",-1)),g[7]||(g[7]=S("p",null," This defines which fields are used by the registration search system. ",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:s.value.badge_name,"onUpdate:modelValue":g[0]||(g[0]=k=>s.value.badge_name=k),label:"Main Badge Name",items:m.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:s.value.forename,"onUpdate:modelValue":g[1]||(g[1]=k=>s.value.forename=k),label:"Forename",items:m.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:s.value.surname,"onUpdate:modelValue":g[2]||(g[2]=k=>s.value.surname=k),label:"Surname",items:m.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:s.value.dob,"onUpdate:modelValue":g[3]||(g[3]=k=>s.value.dob=k),label:"Date of Birth",items:m.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:s.value.address,"onUpdate:modelValue":g[4]||(g[4]=k=>s.value.address=k),label:"Address",items:m.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(F,{type:"submit",color:"success"},Te({default:l(()=>[g[5]||(g[5]=N(" Save "))]),_:2},[f.value?{name:"prepend",fn:l(()=>[e(Ge,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},8,["action"]))}}),Ct={class:"mt-4"},kt=M({__name:"Stripe",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],async setup(T){let p,o;const{getStripeConfig:d,saveStripeConfig:v,stripeConfigKey:i}=Tl(),n=B(),u=q(T,"modelValue"),t=C(([p,o]=_e(()=>d(u.value.ConventionUUID)),p=await p,o(),p)),a=C(!1),s=async()=>{try{a.value=!0,t.value&&await v(u.value.ConventionUUID,t.value)}catch(U){console.error(U)}a.value=!1},f=U=>{try{navigator.clipboard.writeText(U).catch(()=>{})}catch{}};return(U,m)=>(c(),b(He,{method:"post",action:`/api/convention/${u.value.ConventionUUID}/config/${y(i)}`,onSubmit:Q(s,["prevent"]),class:"pa-sm-4"},{default:l(()=>[m[10]||(m[10]=S("h2",null,"Stripe Configuration",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(O,{label:"Private Key","hide-details":"",modelValue:t.value.private_key,"onUpdate:modelValue":m[0]||(m[0]=r=>t.value.private_key=r)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:"Public Key","hide-details":"",modelValue:t.value.public_key,"onUpdate:modelValue":m[1]||(m[1]=r=>t.value.public_key=r)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:"Webhook ID","hide-details":"",modelValue:t.value.webhook_id,"onUpdate:modelValue":m[2]||(m[2]=r=>t.value.webhook_id=r)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:"Webhook Key","hide-details":"",modelValue:t.value.webhook_secret,"onUpdate:modelValue":m[3]||(m[3]=r=>t.value.webhook_secret=r)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{label:"Support Email Address","hide-details":"",modelValue:t.value.support_email,"onUpdate:modelValue":m[4]||(m[4]=r=>t.value.support_email=r)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(fe,{label:"Payment Information","hide-details":"",modelValue:t.value.payment_information_html,"onUpdate:modelValue":m[5]||(m[5]=r=>t.value.payment_information_html=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[m[7]||(m[7]=S("p",{class:"font-weight-bold"}," WebHook URI ",-1)),m[8]||(m[8]=S("p",null,[S("small",null,"Setup a Stripe WebHook using this URI and add all payment_intent events.")],-1)),S("p",Ct,[e(Il,{text:"Click to Copy"},{activator:l(({props:r})=>[S("span",Ne({class:"cursor-pointer",onClick:m[6]||(m[6]=V=>f(`${y(n).getEndPoint()}/stripe/hook/${u.value.ConventionUUID}`))},r),[N(P(y(n).getEndPoint())+"/stripe/hook/"+P(u.value.ConventionUUID)+" ",1),e(X,{icon:"mdi:mdi-clipboard-outline"})],16)]),_:1})])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(F,{type:"submit",color:"success"},Te({default:l(()=>[m[9]||(m[9]=N(" Save "))]),_:2},[a.value?{name:"prepend",fn:l(()=>[e(Ge,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},8,["action"]))}}),Et=M({__name:"PaymentProcessor",props:{convention:{required:!0},conventionModifiers:{}},emits:["update:convention"],setup(T){const p=q(T,"convention"),o=C(""),d=C(),v=C([{id:$(),title:"Stripe",component:ie(kt),model:p}]);return(i,n)=>(c(),R(A,null,[o.value?(c(),b(gl,{key:0,type:"error"},{default:l(()=>[e(yl,null,{default:l(()=>n[2]||(n[2]=[N("Error Encountered")])),_:1}),N(" "+P(o.value),1)]),_:1})):x("",!0),e(qe,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=u=>d.value=u),"bg-color":"secondary","show-arrows":""},{default:l(()=>[(c(!0),R(A,null,L(v.value,(u,t)=>(c(),b(we,{key:t,text:u.title,value:u.id},null,8,["text","value"]))),128))]),_:1},8,["modelValue"]),e(Le,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=u=>d.value=u)},{default:l(()=>[(c(!0),R(A,null,L(v.value,(u,t)=>(c(),b(he,{key:t,value:u.id},{default:l(()=>[e(me,{class:"pa-2"},{default:l(()=>[(c(),b(je(u.component),{modelValue:u.model,"onUpdate:modelValue":a=>u.model=a},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64))}}),ze="reference_settings",Nt=()=>({start_index:"",reserved_values:[],method:al.NONE,min_length:0,max_length:0,add_checksum:!1,checksum_algorithm:ol.NONE}),St=async T=>{const{getConventionConfig:p}=tl();return await p(T,ze)||Nt()},Rt=async(T,p)=>{const{saveConventionConfig:o}=tl();return await o(T,ze,p)};function _t(){return{getReferenceSettings:St,saveReferenceSettings:Rt,ReferenceSettingsKey:ze}}const At=M({__name:"ReferenceSettings",props:{convention:{}},emits:["update:convention"],async setup(T,{emit:p}){let o,d;const v=T,{getReferenceSettings:i,saveReferenceSettings:n,ReferenceSettingsKey:u}=_t(),a=re(v,p,void 0,void 0,"convention"),s=C(([o,d]=_e(()=>i(a.value.ConventionUUID)),o=await o,d(),o)),f=C(!1),U=C(""),m=()=>{U.value.trim()&&(s.value.reserved_values.push(U.value.trim()),U.value="")},r=g=>{s.value.reserved_values.splice(g,1)},V=async()=>{try{f.value=!0,s.value&&await n(a.value.ConventionUUID,s.value)}catch(g){console.error(g)}f.value=!1};return(g,k)=>(c(),b(He,{method:"post",action:`/api/convention/${y(a).ConventionUUID}/config/${y(u)}`,onSubmit:Q(V,["prevent"]),class:"pa-2 pa-sm-4"},{default:l(()=>[k[10]||(k[10]=S("h2",null,"Reference Settings",-1)),k[11]||(k[11]=S("p",null," Controls how references are assigned to registrations. References are a.k.a. Badge Numbers. ",-1)),e(_,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:s.value.method,"onUpdate:modelValue":k[0]||(k[0]=I=>s.value.method=I),label:"Assignment Method",items:y(bl),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{modelValue:s.value.start_index,"onUpdate:modelValue":k[1]||(k[1]=I=>s.value.start_index=I),label:"Initial Value","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{modelValue:s.value.min_length,"onUpdate:modelValue":k[2]||(k[2]=I=>s.value.min_length=I),modelModifiers:{number:!0},label:"Minimum Length","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(O,{modelValue:s.value.max_length,"onUpdate:modelValue":k[3]||(k[3]=I=>s.value.max_length=I),modelModifiers:{number:!0},label:"Maximum Length",hint:"Zero is infinite"},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",class:"py-0"},{default:l(()=>k[7]||(k[7]=[N(" Reserved Values ")])),_:1}),s.value.reserved_values.length>0?(c(),b(D,{key:0,class:"py-0",cols:"12"},{default:l(()=>[(c(!0),R(A,null,L(s.value.reserved_values,(I,E)=>(c(),b(Ke,{key:E,onClick:K=>r(E)},{default:l(()=>[N(P(I),1)]),_:2},1032,["onClick"]))),128))]),_:1})):x("",!0),e(D,{class:"py-0",cols:"8",sm:"10"},{default:l(()=>[e(O,{modelValue:U.value,"onUpdate:modelValue":k[4]||(k[4]=I=>U.value=I),label:"Add item",onKeyup:ul(m,["enter"]),class:"mt-4",clearable:""},null,8,["modelValue"])]),_:1}),e(D,{cols:"4",sm:"2"},{default:l(()=>[e(F,{class:"mt-4",color:"primary",onClick:m,disabled:!U.value},{default:l(()=>k[8]||(k[8]=[N(" Add ")])),_:1},8,["disabled"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(H,{modelValue:s.value.add_checksum,"onUpdate:modelValue":k[5]||(k[5]=I=>s.value.add_checksum=I),label:"Apply Checksum","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Z,{modelValue:s.value.checksum_algorithm,"onUpdate:modelValue":k[6]||(k[6]=I=>s.value.checksum_algorithm=I),label:"Checksum Algorithm",items:y(Cl),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(F,{type:"submit",color:"success"},Te({default:l(()=>[k[9]||(k[9]=N(" Save "))]),_:2},[f.value?{name:"prepend",fn:l(()=>[e(Ge,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},8,["action"]))}}),Oa=M({__name:"ConventionEditorView",emits:["delete","pageTitle","refresh"],setup(T,{emit:p}){const o=p,d=il(),v=B(),n=C({ID:0,ConventionUUID:Re,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),u=C(!1),t=C(`
Are you sure you wish to delete this convention? All data relating to it will be
removed including all registrations and payment information. This action can
not be undone. To confirm type "I UNDERSTAND" in the box below.
`),a=C(),s=C(),f=C([{id:"general",title:"General",component:void 0,model:null},{id:"configuration",title:"Main Configuration",component:void 0,model:null},{id:"linked",title:"Linked Fields",component:void 0,model:null},{id:"payments",title:"Payment Processor",component:void 0,model:null},{id:"references",title:"Reference Numbers",component:void 0,model:null}]),U=C([{id:$(),title:"Accommodation",component:ie(Zl),model:n},{id:$(),title:"Additional Purchases",component:ie(Rl),model:n},{id:$(),title:"Fields",component:ie(rt),model:n},{id:$(),title:"Forms",component:ie(yt),model:n},{id:$(),title:"Interests",component:ie(Ol),model:n},{id:$(),title:"Tickets",component:ie(Bl),model:n},{id:$(),title:"Venues",component:ie(Jl),model:n}]),m=r=>{v.deleteConvention(n.value.ConventionUUID).then(V=>{V?r&&(r("Convention Deleted"),o("delete")):r&&r("Failed to Delete Convention"),setTimeout(()=>{u.value=!1},2e3)}).catch(()=>{r&&(r("Failed to Delete Organisation"),u.value=!1)})};return o("pageTitle","Convention Editor"),v.getConvention(d.params.convention.toString()).then(r=>{r?(n.value=r,o("pageTitle",`Convention Editor - ${n.value.Name}`)):o("pageTitle","Convention Editor - New Convention")}),(r,V)=>(c(),b(oe,null,{default:l(()=>[e(qe,{modelValue:a.value,"onUpdate:modelValue":V[0]||(V[0]=g=>a.value=g),"bg-color":"primary","show-arrows":"","selected-class":"bg-secondary","hide-slider":""},{default:l(()=>[(c(!0),R(A,null,L(f.value,(g,k)=>(c(),b(we,{key:k,text:g.title,value:g.id},null,8,["text","value"]))),128))]),_:1},8,["modelValue"]),e(Le,{modelValue:a.value,"onUpdate:modelValue":V[9]||(V[9]=g=>a.value=g)},{default:l(()=>[(c(!0),R(A,null,L(f.value,(g,k)=>(c(),b(he,{key:k,value:g.id},{default:l(()=>[a.value===g.id?(c(),R(A,{key:0},[g.id==="general"?(c(),R(A,{key:0},[e(Ul,{embed:!0,convention:n.value,"onUpdate:convention":V[1]||(V[1]=I=>n.value=I),onDelete:V[2]||(V[2]=I=>u.value=!0),title:`${n.value.Name} General Settings`},null,8,["convention","title"]),e(Be,{modelValue:u.value,"onUpdate:modelValue":V[3]||(V[3]=I=>u.value=I),"confirmation-text":"I UNDERSTAND",message:t.value,title:"Delete Convention",subtitle:"A quick way to make enemies",onDelete:m},null,8,["modelValue","message"])],64)):g.id==="configuration"?(c(),R(A,{key:1},[n.value&&n.value.ConventionUUID!==y(Re)?(c(),b(qe,{key:0,modelValue:s.value,"onUpdate:modelValue":V[4]||(V[4]=I=>s.value=I),"bg-color":"secondary","show-arrows":""},{default:l(()=>[(c(!0),R(A,null,L(U.value,(I,E)=>(c(),b(we,{key:E,text:I.title,value:I.id},null,8,["text","value"]))),128))]),_:1},8,["modelValue"])):x("",!0),e(Le,{modelValue:s.value,"onUpdate:modelValue":V[5]||(V[5]=I=>s.value=I)},{default:l(()=>[(c(!0),R(A,null,L(U.value,(I,E)=>(c(),b(he,{key:E,value:I.id},{default:l(()=>[e(me,{class:"pa-2"},{default:l(()=>[(c(),b(je(I.component),{modelValue:I.model,"onUpdate:modelValue":K=>I.model=K},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue"])],64)):g.id==="linked"?(c(),b(Me,{key:2},{default:l(()=>[e(bt,{convention:n.value,"onUpdate:convention":V[6]||(V[6]=I=>n.value=I)},null,8,["convention"])]),_:1})):g.id==="payments"?(c(),b(Me,{key:3},{default:l(()=>[e(Et,{convention:n.value,"onUpdate:convention":V[7]||(V[7]=I=>n.value=I)},null,8,["convention"])]),_:1})):g.id==="references"?(c(),b(Me,{key:4},{default:l(()=>[e(At,{convention:n.value,"onUpdate:convention":V[8]||(V[8]=I=>n.value=I)},null,8,["convention"])]),_:1})):x("",!0)],64)):x("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}))}});export{Oa as default};
