import{i as y,M as h,N as b,r,c as G,O as N,w as D,l as V,n as C}from"./index-7f8g6J9S.js";import{V as M}from"./VAutocomplete-BlLyKZgC.js";const w=y({__name:"SelectGroups",props:h({convention:{},organisation:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:h(["change"],["update:modelValue"]),setup(t,{emit:U}){const i=b(t,"modelValue"),f=U,n=r([]),d=N(),v=r([]),c=r([]),s=r(""),u=r(""),m=r(0),p=G(()=>[...v.value,...c.value].map(a=>({title:a.Name,value:n.value.find(e=>e.GroupUUID===a.GroupUUID)||a})));return typeof t.convention=="object"?(s.value=t.convention.ConventionUUID,u.value=t.convention.OrganisationUUID):s.value=t.convention||"",typeof t.organisation=="object"?u.value=t.organisation.OrganisationUUID:u.value.length===0&&(u.value=t.organisation||""),(async()=>{const o=[];s.value&&o.push(d.getConventionGroups(s.value)),u.value&&o.push(d.getOrganisationGroups(u.value));const a=await Promise.all(o);if(s.value&&u.value?(c.value=a[0].sort((e,l)=>e.Name.localeCompare(l.Name)),v.value=a[1].sort((e,l)=>e.Name.localeCompare(l.Name))):s.value&&a.length==1?c.value=a[0].sort((e,l)=>e.Name.localeCompare(l.Name)):u.value&&a.length==1&&(v.value=a[0].sort((e,l)=>e.Name.localeCompare(l.Name))),Array.isArray(i.value))m.value=2,p.value.forEach(e=>{Array.isArray(i.value)&&i.value.find(g=>g.GroupUUID===e.value.GroupUUID)&&n.value.push(e.value)});else if(typeof i.value=="string"){m.value=1;try{const e=JSON.parse(i.value);p.value.forEach(l=>{e.find(I=>I.GroupUUID===l.value.GroupUUID)&&n.value.push(l.value)})}catch{}}})(),D(n,()=>{switch(m.value){default:case 2:{i.value=n.value,f("change");break}case 1:{i.value=JSON.stringify(n.value),f("change");break}}}),(o,a)=>(C(),V(M,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),chips:o.chips,multiple:"",label:o.label||"Tags",variant:o.variant||"solo",hint:o.hint,"persistent-hint":!0,clearable:o.clearable,items:p.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}});export{w as _};
