import{i as J,M as Ce,N as Ae,j as we,r as F,C as Fe,w as ie,O as re,l as i,n as t,q as n,h as r,P as ce,G as p,v as s,y as be,A as y,x as T,k as pe,D as u,H as f,Q as G,F as d,c as B,z as ge,m as Oe}from"./index-Cc2MDANl.js";import{G as ue}from"./userData-BC4OQ5tV.js";import{_ as Re}from"./LoginView.vue_vue_type_script_setup_true_lang-kIzcRkvz.js";import{s as ae}from"./index-zHJ-1AxG.js";import{F as I}from"./form-Cqw16b_M.js";import{S as h,a as Pe}from"./submission-DAi9v6uc.js";import{u as Te}from"./useStoreAPI-DL50v4D_.js";import{c as ee}from"./canEditForm-BQCgLpSO.js";import{s as Ve}from"./sortSubmissions-BLiX_qgz.js";import{P as te,a as Me,u as Ne}from"./useDisplayTransactions-Bvph0WeE.js";import{l as $e}from"./stripe.esm-v5H38J3X.js";import{_ as Ue}from"./ModelDialog.vue_vue_type_script_setup_true_lang-CTSZMy9-.js";import{u as he}from"./useStripeConfig-UDtWo7nQ.js";import{V as se}from"./VContainer-DFlOzN4r.js";import{V as Le}from"./VAlert-Do01Yglx.js";import{V as Ye}from"./VForm-Cm2M5acN.js";import{V as W,a as H}from"./VRow-BeyMI7Hn.js";import{V as v,o as xe}from"./VGrid-BbPkqUTo.js";import{V as Ie}from"./VSpacer-B4IWy_MU.js";import{V as ze}from"./SaveButton.vue_vue_type_script_setup_true_lang-GDRjines.js";import{f as Be,h as ye}from"./date-DgbCHIwC.js";import{i as Ge}from"./index.esm-D__tCrw3.js";import{V as ke,a as oe,b as Se,c as le,d as He,e as De}from"./VCard-BSLXX_92.js";import{V as Ee}from"./forwardRefs-Nj5XGvbu.js";import{V as qe}from"./VTooltip-BL7PC2KO.js";import{V as je,a as Ke,d as We,e as Je}from"./VList-BaVhhU5A.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./emailFormVariant-DbFKH7n9.js";import"./LoginButton-DH9F_irx.js";import"./VToolbar-JZ3jd9c3.js";import"./VDialog-Dy3sGxxX.js";import"./VOverlay-CScIurE4.js";import"./scopeId-BdGPhOEj.js";import"./useConventionConfig-SZUotETj.js";import"./createSimpleFunctional-Bra3Y3vF.js";import"./form-DcagUy2f.js";const Qe=["innerHTML"],Xe=J({__name:"StripePayment",props:Ce({paymentTransactions:{},registration:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],async setup(S){let A,L;const R=Ae(S,"modelValue"),g=re(),l=ue(),D=we(),U=F(),w=F((l==null?void 0:l.Additional.Email)||""),Y=F(!1),q=F("");let x;const j=F(!1),{getStripeConfig:Q}=he(),K=F();S.registration&&(K.value=([A,L]=Fe(()=>Q(S.registration.ConventionUUID)),A=await A,L(),A)),ie(R,P=>{P&&S.registration&&g.stripePublicKey(S.registration.ConventionUUID).then(async c=>{c&&(U.value=await $e(c),await Z(U.value))})});const X=P=>{q.value=P,Y.value=!0};async function Z(P){var m;if(!P)return;const c=await g.stripePaymentIntent(((m=S.registration)==null?void 0:m.RegistrationUUID)||""),V={theme:"stripe"};D.current.value.dark&&(V.theme="night"),x=P.elements({clientSecret:c,appearance:V});const z=x.create("linkAuthentication",{defaultValues:{email:w.value}});z.mount("#link-authentication-element"),z.on("change",E=>{w.value=E.value.email});const a={layout:"tabs"};x.create("payment",a).mount("#payment-element")}async function ne(P,c){var a;if(!c)return;P.preventDefault(),j.value=!0;const V=new URL(location.href);V.pathname+=`payment/stripe/processing/${(a=S.registration)==null?void 0:a.ConventionUUID}`;const{error:z}=await c.confirmPayment({elements:x,confirmParams:{return_url:V.toString(),receipt_email:w.value}});z.type==="card_error"||z.type==="validation_error"?X(z.message):X("An unexpected error occurred."),j.value=!1}return(P,c)=>(t(),i(Ue,{modelValue:R.value,"onUpdate:modelValue":c[4]||(c[4]=V=>R.value=V),title:"Make a Payment",color:"blue-darken-4",fullscreen:"",persistent:""},{default:n(()=>[r(se,{class:"pa-0"},{default:n(()=>[r(Le,{class:"mb-2 stripe-payment-information",closable:!0},ce({title:n(()=>[c[5]||(c[5]=s(" Payment Information "))]),_:2},[K.value?{name:"text",fn:n(()=>[p("div",{innerHTML:K.value.payment_information_html},null,8,Qe)]),key:"0"}:void 0]),1024),r(Ye,{id:"payment-form",onSubmit:c[1]||(c[1]=be(V=>ne(V,U.value),["prevent"]))},{default:n(()=>[r(W,null,{default:n(()=>[r(H,null,{default:n(()=>c[6]||(c[6]=[p("div",{id:"link-authentication-element"},null,-1)])),_:1})]),_:1}),r(W,null,{default:n(()=>[r(H,null,{default:n(()=>c[7]||(c[7]=[p("div",{id:"payment-element"},null,-1)])),_:1})]),_:1}),r(W,null,{default:n(()=>[P.registration?(t(),i(H,{key:0,class:"font-weight-bold text-right"},{default:n(()=>[s(" Payment Amount: £"+T(P.registration.Total-P.registration.Paid),1)]),_:1})):y("",!0)]),_:1}),r(W,null,{default:n(()=>[r(H,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:n(()=>[r(v,{color:"error",class:"w-100",onClick:c[0]||(c[0]=V=>R.value=!1)},{default:n(()=>c[8]||(c[8]=[s("Cancel")])),_:1})]),_:1}),r(Ie),r(H,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:n(()=>[r(v,{type:"submit",color:"success",class:"w-100"},ce({default:n(()=>[c[9]||(c[9]=s(" Pay Now "))]),_:2},[j.value?{name:"prepend",fn:n(()=>[r(xe,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1})]),_:1}),r(ze,{modelValue:Y.value,"onUpdate:modelValue":c[3]||(c[3]=V=>Y.value=V)},{actions:n(()=>[r(v,{variant:"text",onClick:c[2]||(c[2]=V=>Y.value=!1)},{default:n(()=>c[10]||(c[10]=[s(" Close ")])),_:1})]),default:n(()=>[s(T(q.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),Ze={key:0},et={key:1,class:"v-row"},tt={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},nt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ot={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},at={key:1,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},lt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},st={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},it={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},rt={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},ut={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},dt={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},mt=J({__name:"AttendeeTransactionList",props:{paymentTransactions:{},registration:{}},setup(S){const A=S,L=F(pe(A.paymentTransactions));ie(A,()=>{L.value=pe(A.paymentTransactions)});const R=(g,l)=>g.Type===te.PAYMENT_TRANSACTION_TYPE_CHARGE&&l.Type!==te.PAYMENT_TRANSACTION_TYPE_CHARGE?-1:g.Type!==te.PAYMENT_TRANSACTION_TYPE_CHARGE&&l.Type===te.PAYMENT_TRANSACTION_TYPE_CHARGE||(g.UpdatedAt||0)>(l.UpdatedAt||0)?1:g.UpdatedAt===l.UpdatedAt?0:-1;return(g,l)=>g.paymentTransactions.length==0&&g.registration.Total==0?(t(),u("p",Ze," Your registration is currently being processed, payment information will appear here when ready. ")):(t(),u("dl",et,[(t(!0),u(f,null,G(L.value.sort(R),D=>{var U;return t(),u(f,{key:D.PaymentTransactionUUID},[D.Type===d(te).PAYMENT_TRANSACTION_TYPE_CHARGE?(t(),u("dt",tt,[p("div",nt,T(D.Description.split(":")[0]),1),p("div",ot,T(D.Description.split(":")[1]),1)])):(t(),u("dt",at,[p("div",lt,T((U=d(Me).find(w=>w.value===D.Type))==null?void 0:U.title),1),p("div",st," [ "+T(d(Be)(D.UpdatedAt||""))+" ] "+T(D.Description),1)])),p("dd",it," £"+T(D.Amount),1)],64)}),128)),l[0]||(l[0]=p("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),p("dd",rt," £"+T(g.registration.Total),1),l[1]||(l[1]=p("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Current Payments ",-1)),p("dd",ut," £"+T(g.registration.Paid),1),l[2]||(l[2]=p("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance Due ",-1)),p("dd",dt," £"+T(g.registration.Total-g.registration.Paid),1)]))}}),vt=["innerHTML"],ft={key:0},ct={key:0,class:"font-weight-bold float-left pt-1 w-50"},pt={key:1,class:"pa-1"},gt={class:"font-weight-bold float-left pt-1 w-50 pt-3",style:{clear:"both"}},yt={class:"pt-2"},St={key:0,class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},Tt={key:1},Ut={class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},It={class:"text-red-darken-4"},kt={key:1,class:"text-red-darken-4 mt-4"},Dt={class:"text-center"},Et=J({__name:"OpenConvention",props:{convention:{},forms:{default:()=>[]}},setup(S){const A=Te(),L=re(),{getPaymentTransactions:R}=Ne(),g=F(A.GetConventionLogoURL(S.convention.ConventionUUID)),l=F(),D=F([]),U=F([]),w=F([]),Y=F(!1),q=F(!1),x=F([]),j=B(()=>{var a;return ee(S.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_REGISTRATION)}),Q=B(()=>{var a;return ee(S.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_DEALER)}),K=B(()=>{var a;return ee(S.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_BADGE)}),X=B(()=>{var a;return ee(S.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_ACCOMMODATION)}),Z=B(()=>{var a;return ee(S.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_ADDITIONAL)}),ne=B(()=>l.value?S.forms.filter(a=>{var e,m,E,_;return(e=a.State)!=null&&e.Independent?(m=l.value)!=null&&m.Submissions?(_=a.State)!=null&&_.New?!l.value.Submissions.find(C=>{var N;return((N=C.Form)==null?void 0:N.FormUUID)===a.FormUUID}):!1:(E=a.State)==null?void 0:E.New:!1}):S.forms),P=B(()=>{var a,e;return l.value&&((a=l.value)!=null&&a.Submissions)?!!((e=l.value)!=null&&e.Submissions.find(m=>{var E;return((E=m.Form)==null?void 0:E.Type)==I.FORM_TYPE_REGISTRATION&&(m.Status==h.SUBMISSION_STATUS_ACCEPTED||m.Status==h.SUBMISSION_STATUS_COMPLETED)})):!1}),c=B(()=>{var a,e;return l.value&&((a=l.value)!=null&&a.Submissions)?!!((e=l.value)!=null&&e.Submissions.find(m=>{var E;return((E=m.Form)==null?void 0:E.Type)==I.FORM_TYPE_REGISTRATION&&m.Status==h.SUBMISSION_STATUS_COMPLETED})):!1}),V=async()=>{l.value&&"RegistrationUUID"in l.value&&L.getRegistrationAllocationPeriods(l.value.RegistrationUUID).then(a=>{a&&(U.value=[],D.value=a,D.value.sort((e,m)=>e.DateStart>m.DateStart?1:-1).forEach(e=>{var E;const m=U.value.find(_=>{var C;return _.name===((C=e.Accommodation)==null?void 0:C.Name)});if(m){const _=m.periods.find(N=>N.start===e.DateEnd),C=m.periods.find(N=>N.end===e.DateStart);_?_.start=e.DateStart:C?C.end=e.DateEnd:m.periods.push({start:e.DateStart,end:e.DateEnd})}else U.value.push({name:((E=e.Accommodation)==null?void 0:E.Name)||"",periods:[{start:e.DateStart,end:e.DateEnd}]})}))}).catch(()=>{})},z=()=>{L.getRegistrationByConvention(S.convention.ConventionUUID).then(a=>{var e;a&&(a.Submissions?(a.Submissions.forEach((m,E)=>{var C;const _=S.forms.find(N=>N.FormUUID===m.FormUUID);_&&(a.Submissions[E].Form=_),((C=a.Submissions[E].Form)==null?void 0:C.Type)==I.FORM_TYPE_ADMIN&&(a.Submissions[E].Form=void 0)}),Ve(a.Submissions)):a.Submissions=[],l.value=a,V(),P.value&&R(((e=l.value)==null?void 0:e.RegistrationUUID)||"").then(m=>{w.value=m}))})};return ie(()=>S.forms,()=>{z()}),z(),(a,e)=>{const m=ge("router-link"),E=ge("RouterLink");return t(),i(De,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:n(()=>[r(ke,{class:"flex-1-1 align-content-start"},{default:n(()=>[g.value?(t(),i(Ee,{key:0,src:g.value,title:a.convention.Name,class:"logo text-center"},null,8,["src","title"])):y("",!0),a.convention.Name?(t(),i(oe,{key:1,class:"text-center"},{default:n(()=>[s(T(a.convention.Name),1)]),_:1})):y("",!0),a.convention.Description?(t(),i(Se,{key:2,class:"text-wrap subtitle"},{default:n(()=>[p("div",{innerHTML:a.convention.Description},null,8,vt)]),_:1})):y("",!0)]),_:1}),r(le,null,{default:n(()=>{var _,C,N;return[l.value?(t(),u("dl",ft,[l.value.Reference?(t(),u("dt",ct," Badge No: ")):y("",!0),l.value.Reference?(t(),u("dd",pt," #"+T(l.value.Reference),1)):y("",!0),ne.value.length>0?(t(),u(f,{key:2},[e[5]||(e[5]=p("dt",null,[p("h3",null,"Forms Available")],-1)),e[6]||(e[6]=p("dd",{class:"mb-2"}," The following forms are currently available for completion. ",-1))],64)):y("",!0),(t(!0),u(f,null,G(ne.value,(o,$)=>(t(),u(f,{key:o.FormUUID},[p("dt",gt,T(o.Heading),1),p("dd",yt,[(o==null?void 0:o.Type)===d(I).FORM_TYPE_DEALER?(t(),i(m,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer/${o.FormUUID}`},{default:n(()=>{var O;return[(O=o==null?void 0:o.State)!=null&&O.Edit&&Q.value?(t(),i(v,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:n(()=>e[7]||(e[7]=[s(" Open form ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[8]||(e[8]=[s("View")])),_:1}))]}),_:2},1032,["to"])):(o==null?void 0:o.Type)===d(I).FORM_TYPE_BADGE?(t(),i(m,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge/${o.FormUUID}`},{default:n(()=>{var O;return[(O=o==null?void 0:o.State)!=null&&O.Edit&&K.value?(t(),i(v,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:n(()=>e[9]||(e[9]=[s(" Open form ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[10]||(e[10]=[s("View")])),_:1}))]}),_:2},1032,["to"])):(o==null?void 0:o.Type)===d(I).FORM_TYPE_ADDITIONAL?(t(),i(m,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional/${o.FormUUID}`},{default:n(()=>{var O;return[(O=o==null?void 0:o.State)!=null&&O.Edit&&Z.value?(t(),i(v,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:n(()=>e[11]||(e[11]=[s(" Open form ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[12]||(e[12]=[s("View")])),_:1}))]}),_:2},1032,["to"])):y("",!0)])],64))),128)),((_=l.value)==null?void 0:_.Submissions.length)>0?(t(),u(f,{key:3},[e[13]||(e[13]=p("dt",{class:"mt-3"},[p("h3",null,"Received Forms")],-1)),e[14]||(e[14]=p("dd",{class:"mb-2"}," The following forms have been received from you. ",-1))],64)):y("",!0),(t(!0),u(f,null,G((C=l.value)==null?void 0:C.Submissions,(o,$)=>{var O,k,de,me,ve,fe;return t(),u(f,{key:o.SubmissionUUID},[o.Form?(t(),u(f,{key:0},[o.Form?(t(),u("dt",St,T(o.Form.Heading),1)):y("",!0),o.Form?(t(),u("dd",Tt,[r(qe,{modelValue:x.value[$],"onUpdate:modelValue":b=>x.value[$]=b},{activator:n(({props:b})=>[r(v,Oe({ref_for:!0},b,{color:"blue-darken-2",icon:"mdi:mdi-information",variant:"text",size:"xs",onClick:M=>x.value[$]=!x.value[$]}),null,16,["onClick"])]),default:n(()=>[o.Status===d(h).SUBMISSION_STATUS_NULL?(t(),u(f,{key:0},[s(" There is an error with your submission, please contact the registration team for support. ")],64)):o.Status===d(h).SUBMISSION_STATUS_INCOMPLETE?(t(),u(f,{key:1},[s(" Something is missing on your submission which requires completing to be able to process your request. Please contact the registration team for further advice. ")],64)):o.Status===d(h).SUBMISSION_STATUS_OPEN?(t(),u(f,{key:2},[s(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):o.Status===d(h).SUBMISSION_STATUS_OPEN_2?(t(),u(f,{key:3},[s(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):o.Status===d(h).SUBMISSION_STATUS_LOCKED?(t(),u(f,{key:4},[s(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===d(h).SUBMISSION_STATUS_LOCKED_2?(t(),u(f,{key:5},[s(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===d(h).SUBMISSION_STATUS_ACCEPTED?(t(),u(f,{key:6},[s(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===d(h).SUBMISSION_STATUS_COMPLETED?(t(),u(f,{key:7},[s(" Congratulations everything is complete. If you need to make changes please get in touch. ")],64)):o.Status===d(h).SUBMISSION_STATUS_REJECTED?(t(),u(f,{key:8},[s(" Your request has been unsuccessful. Contact the convention team for assistance. ")],64)):o.Status===d(h).SUBMISSION_STATUS_INVALID?(t(),u(f,{key:9},[s(" Your request has been identified as having errors or being incomplete. Please contact the registration team for additional support. ")],64)):o.Status===d(h).SUBMISSION_STATUS_CANCELLED?(t(),u(f,{key:10},[s(" Your submission has been cancelled. This may be at your request or another reason. The registration team will be able to provide further details. ")],64)):(t(),u(f,{key:11},[s(" Please contact the registration team for support. ")],64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(" "+T(d(Pe)(o.Status,(O=o.Form)==null?void 0:O.Type))+" ",1),((k=o.Form)==null?void 0:k.Type)===d(I).FORM_TYPE_REGISTRATION?(t(),i(m,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/registration/${o.FormUUID}`},{default:n(()=>{var b,M;return[(M=(b=o.Form)==null?void 0:b.State)!=null&&M.Edit&&j.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[15]||(e[15]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[16]||(e[16]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((de=o.Form)==null?void 0:de.Type)===d(I).FORM_TYPE_ACCOMMODATION?(t(),i(m,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/accommodation/${o.FormUUID}`},{default:n(()=>{var b,M;return[(M=(b=o.Form)==null?void 0:b.State)!=null&&M.Edit&&X.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[17]||(e[17]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[18]||(e[18]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((me=o.Form)==null?void 0:me.Type)===d(I).FORM_TYPE_DEALER?(t(),i(m,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer/${o.FormUUID}`},{default:n(()=>{var b,M;return[(M=(b=o.Form)==null?void 0:b.State)!=null&&M.Edit&&Q.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[19]||(e[19]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[20]||(e[20]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((ve=o.Form)==null?void 0:ve.Type)===d(I).FORM_TYPE_BADGE?(t(),i(m,{key:3,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge/${o.FormUUID}`},{default:n(()=>{var b,M;return[(M=(b=o.Form)==null?void 0:b.State)!=null&&M.Edit&&K.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[21]||(e[21]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[22]||(e[22]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((fe=o.Form)==null?void 0:fe.Type)===d(I).FORM_TYPE_ADDITIONAL?(t(),i(m,{key:4,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional/${o.FormUUID}`},{default:n(()=>{var b,M;return[(M=(b=o.Form)==null?void 0:b.State)!=null&&M.Edit&&Z.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[23]||(e[23]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[24]||(e[24]=[s("View")])),_:1}))]}),_:2},1032,["to"])):y("",!0)])):y("",!0)],64)):y("",!0)],64)}),128)),((N=l.value)==null?void 0:N.Submissions.length)>=1?(t(!0),u(f,{key:4},G(a.forms,o=>{var $,O;return t(),u(f,{key:o.FormUUID},[!(($=l.value)!=null&&$.Submissions.find(k=>k.FormUUID===o.FormUUID))&&!((O=o.State)!=null&&O.Independent)?(t(),u(f,{key:0},[p("dt",Ut,T(o.Heading),1),p("dd",It,[e[35]||(e[35]=s(" Requires Completion ")),o.Type===d(I).FORM_TYPE_REGISTRATION?(t(),i(m,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/registration/${o.FormUUID}`},{default:n(()=>{var k;return[(k=o.State)!=null&&k.Edit&&j.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[25]||(e[25]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[26]||(e[26]=[s("View")])),_:1}))]}),_:2},1032,["to"])):o.Type===d(I).FORM_TYPE_ACCOMMODATION?(t(),i(m,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/accommodation/${o.FormUUID}`},{default:n(()=>{var k;return[(k=o.State)!=null&&k.Edit&&X.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[27]||(e[27]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[28]||(e[28]=[s("View")])),_:1}))]}),_:2},1032,["to"])):o.Type===d(I).FORM_TYPE_DEALER?(t(),i(m,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer/${o.FormUUID}`},{default:n(()=>{var k;return[(k=o.State)!=null&&k.Edit&&Q.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[29]||(e[29]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[30]||(e[30]=[s("View")])),_:1}))]}),_:2},1032,["to"])):o.Type===d(I).FORM_TYPE_BADGE?(t(),i(m,{key:3,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge/${o.FormUUID}`},{default:n(()=>{var k;return[(k=o.State)!=null&&k.Edit&&K.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[31]||(e[31]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[32]||(e[32]=[s("View")])),_:1}))]}),_:2},1032,["to"])):o.Type===d(I).FORM_TYPE_ADDITIONAL?(t(),i(m,{key:4,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional/${o.FormUUID}`},{default:n(()=>{var k;return[(k=o.State)!=null&&k.Edit&&Z.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[33]||(e[33]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[34]||(e[34]=[s("View")])),_:1}))]}),_:2},1032,["to"])):y("",!0)])],64)):y("",!0)],64)}),128)):y("",!0)])):y("",!0),l.value&&l.value.Submissions.length>=1&&a.forms.filter(o=>{var $,O;return!(($=o.State)!=null&&$.Independent)&&!((O=l.value)!=null&&O.Submissions.find(k=>k.FormUUID==o.FormUUID))}).length>0?(t(),u("div",kt,e[36]||(e[36]=[p("strong",null,"There are forms above that require completion, please edit and save them.",-1)]))):y("",!0)]}),_:1}),U.value.length>0?(t(),u(f,{key:0},[r(oe,{class:"pb-0"},{default:n(()=>e[37]||(e[37]=[s("Allocated Accommodation")])),_:1}),r(Se,{class:"text-wrap"},{default:n(()=>e[38]||(e[38]=[s("The following accommodation has been allocated to your registration. In some cases this may not have been your first choice.")])),_:1}),r(le,null,{default:n(()=>[r(je,{density:"compact"},{default:n(()=>[(t(!0),u(f,null,G(U.value,_=>(t(),i(Ke,{key:_.name},{default:n(()=>[r(We,null,{default:n(()=>[s(T(_.name),1)]),_:2},1024),(t(!0),u(f,null,G(_.periods,C=>(t(),i(Je,{key:C.start},{default:n(()=>[s(" ("+T(d(ye)(C.start))+" - "+T(d(ye)(C.end))+")",1),e[39]||(e[39]=p("br",null,null,-1))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})],64)):y("",!0),P.value&&l.value?(t(),u(f,{key:1},[r(oe,{class:"pb-4"},{default:n(()=>e[40]||(e[40]=[s("Payment Information")])),_:1}),r(le,null,{default:n(()=>[r(mt,{"payment-transactions":w.value,registration:l.value},null,8,["payment-transactions","registration"])]),_:1})],64)):y("",!0),r(He,null,{default:n(()=>{var _,C,N;return[a.convention.DetailLink?(t(),i(v,{key:0,color:"warning",href:a.convention.DetailLink,variant:"flat"},{default:n(()=>[s(T(d(ae).buttonDetails),1)]),_:1},8,["href"])):y("",!0),r(Ie),j.value?(t(),u(f,{key:1},[(_=l.value)!=null&&_.Submissions.find(o=>{var $;return(($=o.Form)==null?void 0:$.Type)===d(I).FORM_TYPE_REGISTRATION})?(t(),i(E,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}`},{default:n(()=>[r(v,{color:"primary",variant:"flat"},{default:n(()=>[s(T(d(ae).buttonViewRegistration),1)]),_:1})]),_:1},8,["to"])):(t(),u(f,{key:0},[(N=(C=a.forms.find(o=>o.Type===d(I).FORM_TYPE_REGISTRATION))==null?void 0:C.State)!=null&&N.New?(t(),i(E,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}`},{default:n(()=>[r(v,{color:"success",variant:"flat"},{default:n(()=>[s(T(d(ae).buttonRegister),1)]),_:1})]),_:1},8,["to"])):y("",!0)],64))],64)):P.value&&l.value&&l.value.Total>l.value.Paid?(t(),u(f,{key:2},[r(v,{color:"success",variant:"elevated",onClick:e[0]||(e[0]=o=>Y.value=!0)},{default:n(()=>e[41]||(e[41]=[s(" Make Payment ")])),_:1}),l.value?(t(),i(Xe,{key:0,"payment-transactions":w.value,registration:l.value,modelValue:Y.value,"onUpdate:modelValue":e[1]||(e[1]=o=>Y.value=o)},null,8,["payment-transactions","registration","modelValue"])):y("",!0)],64)):l.value&&c.value&&l.value.Total==l.value.Paid?(t(),u(f,{key:3},[r(v,{color:"success",variant:"elevated",onClick:e[2]||(e[2]=o=>q.value=!0)},{default:n(()=>e[42]||(e[42]=[s(" Show Ticket ")])),_:1}),r(Ue,{modelValue:q.value,"onUpdate:modelValue":e[4]||(e[4]=o=>q.value=o),scrollable:!0,title:"Convention Ticket",width:"auto"},{actions:n(()=>[r(v,{onClick:e[3]||(e[3]=o=>q.value=!1),width:"100%"},{default:n(()=>e[43]||(e[43]=[s("Close")])),_:1})]),default:n(()=>[r(d(Ge),{value:l.value.RegistrationUUID,width:"200"},null,8,["value"]),p("p",Dt,[p("strong",null,"#"+T(l.value.Reference),1)])]),_:1},8,["modelValue"])],64)):y("",!0)]}),_:1})]),_:1})}}}),_t=_e(Et,[["__scopeId","data-v-22db60a2"]]),Ct=J({__name:"Conventions",setup(S){const A=re(),L=Te(),R=F([]),g=F([]),l=F([]);return A.getOpenConventionsList().then(D=>{D&&(g.value=[...g.value,...D],A.getAvailableConventionForms(g.value.map(U=>U.ConventionUUID)).then(U=>{l.value=[...l.value,...U]}).catch(U=>{console.error(U)}),A.getAttendedConventions().then(U=>{R.value=U}))}).catch(()=>{}),(D,U)=>(t(),u(f,null,[r(se,null,{default:n(()=>[r(W,{class:"justify-center"},{default:n(()=>[(t(!0),u(f,null,G(g.value,w=>(t(),i(H,{key:w.ConventionUUID,cols:"12",sm:"11",md:"11",lg:"8",xl:"6",class:"d-flex flex-column"},{default:n(()=>[r(_t,{convention:w,forms:l.value.filter(Y=>Y.ConventionUUID===w.ConventionUUID)},null,8,["convention","forms"])]),_:2},1024))),128))]),_:1})]),_:1}),R.value.length>0?(t(),i(se,{key:0,fluid:"",class:"px-0"},{default:n(()=>[r(W,{class:"bg-blue-darken-4"},{default:n(()=>[r(H,null,{default:n(()=>U[0]||(U[0]=[p("h3",{class:"font-weight-regular px-4"}," Convention Sticker Collection ",-1)])),_:1})]),_:1}),r(W,{class:"justify-center"},{default:n(()=>[(t(!0),u(f,null,G(R.value,w=>(t(),i(H,{key:w.ConventionUUID,cols:"8",sm:"6",md:"4",lg:"3",xl:"2"},{default:n(()=>[r(De,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:n(()=>[r(ke,{class:"flex-1-1 align-content-start"},{default:n(()=>[r(Ee,{src:d(L).GetConventionLogoURL(w.ConventionUUID),title:w.Name,class:"logo text-center"},null,8,["src","title"]),w.Name?(t(),i(oe,{key:0,class:"text-center text-wrap"},{default:n(()=>[s(T(w.Name),1)]),_:2},1024)):y("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):y("",!0)],64))}}),At={};function wt(S,A){return t(),u("div")}const Ft=_e(At,[["render",wt]]),bt=J({__name:"MainView",emits:["pageTitle"],setup(S,{emit:A}){A("pageTitle","Upcoming Conventions"),sessionStorage.getItem("reload")==="true"&&(sessionStorage.removeItem("reload"),setTimeout(()=>{location.reload()},500));const g=localStorage.getItem("gjt_token"),l=localStorage.getItem("ajt_token");return g?(localStorage.removeItem("gjt_token"),location.href=g):l&&(localStorage.removeItem("ajt_token"),location.href=l),F(ue()),(D,U)=>(t(),u(f,null,[r(Ct),r(Ft)],64))}}),cn=J({__name:"Home",props:{loggedIn:{type:Boolean}},emits:["pageTitle"],setup(S,{emit:A}){const L=ue(),R=A;return R("pageTitle","Login"),(g,l)=>(t(),u("div",null,[g.loggedIn&&d(L)?(t(),i(bt,{key:0,onPageTitle:l[0]||(l[0]=D=>R("pageTitle",D))})):(t(),i(Re,{key:1}))]))}});export{cn as default};
