import{i as N,M as p,N as E,l as r,n as o,q as t,h as n,A as f,v as c,x as C,D as y,Q as F,H as w,Y as I,y as b}from"./index-D1IdJcDr.js";import{s as g,a as S,m as L}from"./useConventionSlug-DmVE6Ptb.js";import{e as M,c as z}from"./VCard-BoUJuUZM.js";import{V as A,a as q}from"./VToolbar-DakFPRLD.js";import{V as i,d as h}from"./VGrid-Bv_0hRDR.js";import{V as U}from"./VSpacer-BrfhdX1T.js";import{V as H}from"./VToolbarItems-Bj17TBFH.js";import{V as K,a as Q,b as Y,c as j}from"./VExpansionPanels-CtPWUQt0.js";import{u as x}from"./useConventionConfig-DPhG4lbi.js";const oe=N({__name:"EditOrderedItems",props:p({closeable:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!0},hasOrder:{type:Boolean,default:!0},newItem:{type:[Function,Boolean]},label:{default:"Name"},labelParent:{default:""},title:{default:"Edit Ordered Items"},showSave:{type:Boolean,default:!1},slotNamePrefix:{default:"item"}},{modelValue:{required:!0},modelModifiers:{}}),emits:p(["add","save","close"],["update:modelValue"]),setup(l,{emit:d}){const u=d,a=E(l,"modelValue"),O=()=>{u("save"),u("close")},P=()=>{if(l.newItem){let e;l.hasOrder?(e=l.newItem(),e.Order=a.value.length+1):e=l.newItem(),a.value.push(e)}else l.hasOrder?a.value.push({ID:0,Order:a.value.length+1}):a.value.push({ID:0})},$=e=>{a.value.splice(e,1)},B=e=>{S(e,a.value)},D=e=>{L(e,a.value)},T=e=>l.labelParent&&e[l.labelParent]?e[l.labelParent][l.label]:e[l.label];return a.value.find(e=>e.Order===0)&&g(a.value),a.value.find(e=>a.value.find(s=>s.Order===e.Order&&s!==e))&&g(a.value),(e,s)=>(o(),r(M,null,{default:t(()=>[n(A,{dark:"",color:"primary"},{default:t(()=>[e.closeable?(o(),r(i,{key:0,icon:"",dark:"",onClick:s[0]||(s[0]=m=>u("close"))},{default:t(()=>[n(h,null,{default:t(()=>s[1]||(s[1]=[c("mdi:mdi-close")])),_:1})]),_:1})):f("",!0),n(q,null,{default:t(()=>[c(C(e.title),1)]),_:1}),n(U),n(H,null,{default:t(()=>[e.newItem!==void 0?(o(),r(i,{key:0,variant:"text",onClick:P},{default:t(()=>s[2]||(s[2]=[c(" Add ")])),_:1})):f("",!0),e.showSave?(o(),r(i,{key:1,variant:"text",onClick:O},{default:t(()=>s[3]||(s[3]=[c(" Save ")])),_:1})):f("",!0)]),_:1})]),_:1}),n(z,{class:"pa-0"},{default:t(()=>[n(K,null,{default:t(()=>[(o(!0),y(w,null,F(a.value,(m,v)=>(o(),r(Q,{key:m.ID,class:"mt-0"},{default:t(()=>[n(Y,null,{actions:t(({expanded:k})=>[e.showDelete?(o(),r(i,{key:0,icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:W=>$(v)},null,8,["onClick"])):f("",!0),n(h,{class:"align-self-center text-h5",icon:k?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:t(()=>[e.hasOrder?(o(),y(w,{key:0},[n(i,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:b(k=>D(m),["stop"])},null,8,["onClick"]),n(i,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:b(k=>B(m),["stop"])},null,8,["onClick"])],64)):f("",!0),I(e.$slots,`${e.slotNamePrefix}_${v}_title`,{},()=>[c(C(T(m)),1)])]),_:2},1024),n(j,{class:"px-0"},{default:t(()=>[I(e.$slots,`${e.slotNamePrefix}_${v}`)]),_:2},1024)]),_:2},1024))),128))]),_:3})]),_:3})]),_:3}))}}),V="linked_fields",G=()=>({badge_name:"",forename:"",surname:"",dob:"",address:""}),J=async l=>{const{getConventionConfig:d}=x();return await d(l,V)||G()},R=async(l,d)=>{const{saveConventionConfig:u}=x();return await u(l,V,d)};function re(){return{getLinkedFields:J,saveLinkedFields:R,linkedFieldsKey:V}}export{oe as _,re as u};
