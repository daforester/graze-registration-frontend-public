import{i as q,M as D,N as I,r as C,k as V,w as N,$ as U,l as L,n as _,F as u,q as o,h as e,A,O as k}from"./index-D1IdJcDr.js";import{_ as T}from"./ModelDialog.vue_vue_type_script_setup_true_lang-BNijRK1W.js";import{s}from"./index-zHJ-1AxG.js";import{u as B}from"./useStoreAPI-DRgmhfwe.js";import{_ as E}from"./SelectGroups.vue_vue_type_script_setup_true_lang-BknYsC4m.js";import{V as m,a as i}from"./VRow-BUrnHE6j.js";import{V as P}from"./forwardRefs-KgRCCg1e.js";import{V as g}from"./VTextField-W5fcvv2H.js";import{V as j}from"./VTextarea-BSDFJ2fZ.js";import{V as z}from"./VCheckbox-DsAX1z5Y.js";import{V as O}from"./VForm-Bup78EW9.js";import{V as H}from"./VFileInput-D3EziWI6.js";import{V as J}from"./VContainer-Chowp3GE.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=q({__name:"EditConventionDialog",props:D({embed:{type:Boolean},title:{}},{modelValue:{type:Boolean,required:!1},modelModifiers:{},convention:{required:!0},conventionModifiers:{}}),emits:D(["update:convention","delete","save"],["update:modelValue","update:convention"]),setup(d,{emit:F}){const w=d,R=k(),v=B(),{title:y=""}=w,c=F,b=I(d,"modelValue"),r=I(d,"convention"),a=C(V(r.value));N(r,()=>{a.value=V(r.value),p.value=`${v.GetConventionLogoURL(a.value.ConventionUUID)}?${new Date().getTime()}`});const p=C(`${v.GetConventionLogoURL(a.value.ConventionUUID)}?${new Date().getTime()}`),f=U("imageFileInput"),x=U("conventionImageForm"),M=()=>{f.value&&f.value.files&&(p.value=URL.createObjectURL(f.value.files[0]))},G=()=>{c("delete")},S=()=>{a.value=V(r.value)},$=async()=>{var l;const n=new FormData((l=x.value)==null?void 0:l.$el);if(n.get("Image")&&n.get("Image").size>0)return n.set("ConventionUUID",a.value.ConventionUUID),await v.SaveConventionLogo(n)},h=n=>{$(),R.saveConvention(a.value).then(l=>{l?n&&n("Convention Data Saved").then(()=>{r.value=l,c("save",l)}):n&&n("Failed to save")}).catch(()=>{n("Failed to save")})};return(n,l)=>(_(),L(T,{modelValue:b.value,"onUpdate:modelValue":l[6]||(l[6]=t=>b.value=t),onDelete:G,onReset:S,onSave:h,title:u(y),color:"primary","show-close-action":!0,"show-delete-action":!0,"show-reset-action":!0,"show-save-action":!0,fullscreen:!0,persistent:!0,embed:n.embed},{default:o(()=>[e(J,{class:"pa-0",fluid:!0},{default:o(()=>[e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(P,{class:"imgLogo mx-auto",src:p.value||""},null,8,["src"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(g,{label:u(s).formLabelName,name:"Name",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.Name=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(j,{label:u(s).formLabelDescription,name:"Description",variant:"outlined",multiline:"true",modelValue:a.value.Description,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.Description=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(g,{label:u(s).formLabelDetailLink,name:"DetailLink",variant:"outlined",multiline:"true",modelValue:a.value.DetailLink,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.DetailLink=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(g,{label:u(s).formLabelSlug,name:"Slug",variant:"outlined",multiline:"true",modelValue:a.value.Slug,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.Slug=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:o(()=>[e(z,{label:u(s).formConventionVisible,name:"Visible",modelValue:a.value.Visible,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.Visible=t)},null,8,["label","modelValue"])]),_:1}),e(i,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:o(()=>[a.value.RequiredGroupMemberships?(_(),L(E,{key:0,label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.RequiredGroupMemberships=t),convention:a.value,chips:"",clearable:"",hint:"Groups that a user must be in to see this convention. (Any one, empty = public)"},null,8,["modelValue","convention"])):A("",!0)]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(O,{ref:"conventionImageForm",enctype:"multipart/form-data"},{default:o(()=>[e(H,{label:u(s).formLabelLogo,name:"Image",variant:"outlined",ref:"imageFileInput",accept:"image/avif, image/bmp, image/gif, image/jpeg, image/png, image/webp","hide-details":"",onChange:M},null,8,["label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","embed"]))}}),re=K(Q,[["__scopeId","data-v-6235651b"]]);export{re as E};
